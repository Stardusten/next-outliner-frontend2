(async()=>{function xo(r){return new Promise(e=>setTimeout(e,r))}var So=""+new URL("loro_wasm_bg-Xkzt_Cjx.wasm",import.meta.url).href,Ao=async(r={},e)=>{let t;if(e.startsWith("data:")){const n=e.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(n,"base64");else if(typeof atob=="function"){const s=atob(n);o=new Uint8Array(s.length);for(let i=0;i<s.length;i++)o[i]=s.charCodeAt(i)}else throw new Error("Cannot decode base64-encoded data URL");t=await WebAssembly.instantiate(o,r)}else{const n=await fetch(e),o=n.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))t=await WebAssembly.instantiateStreaming(n,r);else{const s=await n.arrayBuffer();t=await WebAssembly.instantiate(s,r)}}return t.instance.exports};let _;function wt(r){_=r}const T=new Array(128).fill(void 0);T.push(void 0,null,!0,!1);function h(r){return T[r]}let Ne=T.length;function Co(r){r<132||(T[r]=Ne,Ne=r)}function l(r){const e=h(r);return Co(r),e}const To=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let Yt=new To("utf-8",{ignoreBOM:!0,fatal:!0});Yt.decode();let et=null;function me(){return(et===null||et.byteLength===0)&&(et=new Uint8Array(_.memory.buffer)),et}function N(r,e){return r=r>>>0,Yt.decode(me().subarray(r,r+e))}function u(r){Ne===T.length&&T.push(T.length+1);const e=Ne;return Ne=T[e],T[e]=r,e}let x=0;const Io=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let st=new Io("utf-8");const Oo=typeof st.encodeInto=="function"?function(r,e){return st.encodeInto(r,e)}:function(r,e){const t=st.encode(r);return e.set(t),{read:r.length,written:t.length}};function O(r,e,t){if(t===void 0){const d=st.encode(r),p=e(d.length,1)>>>0;return me().subarray(p,p+d.length).set(d),x=d.length,p}let n=r.length,o=e(n,1)>>>0;const s=me();let i=0;for(;i<n;i++){const d=r.charCodeAt(i);if(d>127)break;s[o+i]=d}if(i!==n){i!==0&&(r=r.slice(i)),o=t(o,n,n=i+r.length*3,1)>>>0;const d=me().subarray(o+i,o+n),p=Oo(r,d);i+=p.written,o=t(o,n,i,1)>>>0}return x=i,o}function j(r){return r==null}let tt=null;function a(){return(tt===null||tt.byteLength===0)&&(tt=new Int32Array(_.memory.buffer)),tt}let rt=null;function Kt(){return(rt===null||rt.byteLength===0)&&(rt=new Float64Array(_.memory.buffer)),rt}let nt=null;function Eo(){return(nt===null||nt.byteLength===0)&&(nt=new BigInt64Array(_.memory.buffer)),nt}function mt(r){const e=typeof r;if(e=="number"||e=="boolean"||r==null)return`${r}`;if(e=="string")return`"${r}"`;if(e=="symbol"){const o=r.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=r.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(r)){const o=r.length;let s="[";o>0&&(s+=mt(r[0]));for(let i=1;i<o;i++)s+=", "+mt(r[i]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(r));let n;if(t.length>1)n=t[1];else return toString.call(r);if(n=="Object")try{return"Object("+JSON.stringify(r)+")"}catch{return"Object"}return r instanceof Error?`${r.name}: ${r.message}
${r.stack}`:n}const Et=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>{_.__wbindgen_export_2.get(r.dtor)(r.a,r.b)});function Gt(r,e,t,n){const o={a:r,b:e,cnt:1,dtor:t},s=(...i)=>{o.cnt++;const d=o.a;o.a=0;try{return n(d,o.b,...i)}finally{--o.cnt===0?(_.__wbindgen_export_2.get(o.dtor)(d,o.b),Et.unregister(o)):o.a=d}};return s.original=o,Et.register(s,o,o),s}function No(r,e,t){_.__wbindgen_export_3(r,e,u(t))}function Ro(r,e){_.__wbindgen_export_4(r,e)}function se(r,e){return r=r>>>0,me().subarray(r/1,r/1+e)}function ue(r,e){const t=e(r.length*1,1)>>>0;return me().set(r,t/1),x=r.length,t}let ot=null;function Qt(){return(ot===null||ot.byteLength===0)&&(ot=new Uint32Array(_.memory.buffer)),ot}function $(r,e){r=r>>>0;const n=Qt().subarray(r/4,r/4+e),o=[];for(let s=0;s<n.length;s++)o.push(l(n[s]));return o}function Mo(){_.run()}function Z(r,e){const t=e(r.length*4,4)>>>0,n=Qt();for(let o=0;o<r.length;o++)n[t/4+o]=u(r[o]);return x=r.length,t}function Do(r){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=Z(r,_.__wbindgen_export_0),p=x;_.encodeFrontiers(i,d,p);var e=a()[i/4+0],t=a()[i/4+1],n=a()[i/4+2],o=a()[i/4+3];if(o)throw l(n);var s=se(e,t).slice();return _.__wbindgen_export_5(e,t*1,1),s}finally{_.__wbindgen_add_to_stack_pointer(16)}}function jo(r){try{const o=_.__wbindgen_add_to_stack_pointer(-16),s=ue(r,_.__wbindgen_export_0),i=x;_.decodeFrontiers(o,s,i);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}function Lo(){_.setDebug()}let R=128;function U(r){if(R==1)throw new Error("out of js stack");return T[--R]=r,R}function pe(r,e){if(!(r instanceof e))throw new Error(`expected instance of ${e.name}`);return r.ptr}function Uo(r,e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(r,_.__wbindgen_export_0),d=x;_.decodeImportBlobMeta(s,i,d,e);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}function M(r,e){try{return r.apply(this,e)}catch(t){_.__wbindgen_export_6(u(t))}}function Zo(r){return()=>{throw new Error(`${r} is not defined`)}}const Fo=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_awarenesswasm_free(r>>>0));class Vo{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Fo.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_awarenesswasm_free(e)}constructor(e,t){const n=_.awarenesswasm_new(u(e),t);return this.__wbg_ptr=n>>>0,this}encode(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.awarenesswasm_encode(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=se(t,n).slice();return _.__wbindgen_export_5(t,n*1,1),o}finally{_.__wbindgen_add_to_stack_pointer(16)}}encodeAll(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.awarenesswasm_encodeAll(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=se(e,t).slice();return _.__wbindgen_export_5(e,t*1,1),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}apply(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(e,_.__wbindgen_export_0),d=x;_.awarenesswasm_apply(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}setLocalState(e){_.awarenesswasm_setLocalState(this.__wbg_ptr,u(e))}peer(){const e=_.awarenesswasm_peer(this.__wbg_ptr);return l(e)}getAllStates(){const e=_.awarenesswasm_getAllStates(this.__wbg_ptr);return l(e)}getState(e){const t=_.awarenesswasm_getState(this.__wbg_ptr,u(e));return l(t)}getTimestamp(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.awarenesswasm_getTimestamp(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=Kt()[o/8+1];return t===0?void 0:n}finally{_.__wbindgen_add_to_stack_pointer(16)}}removeOutdated(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.awarenesswasm_removeOutdated(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}length(){return _.awarenesswasm_length(this.__wbg_ptr)}isEmpty(){return _.awarenesswasm_isEmpty(this.__wbg_ptr)!==0}peers(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.awarenesswasm_peers(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}}const Nt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_cursor_free(r>>>0));class te{static __wrap(e){e=e>>>0;const t=Object.create(te.prototype);return t.__wbg_ptr=e,Nt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Nt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_cursor_free(e)}containerId(){const e=_.cursor_containerId(this.__wbg_ptr);return l(e)}pos(){const e=_.cursor_pos(this.__wbg_ptr);return l(e)}side(){const e=_.cursor_side(this.__wbg_ptr);return l(e)}encode(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.cursor_encode(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=se(e,t).slice();return _.__wbindgen_export_5(e,t*1,1),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}static decode(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(e,_.__wbindgen_export_0),d=x;_.cursor_decode(s,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return te.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}kind(){const e=_.cursor_kind(this.__wbg_ptr);return l(e)}}const Rt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorocounter_free(r>>>0));class He{static __wrap(e){e=e>>>0;const t=Object.create(He.prototype);return t.__wbg_ptr=e,Rt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Rt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorocounter_free(e)}constructor(){const e=_.lorocounter_new();return this.__wbg_ptr=e>>>0,this}increment(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorocounter_increment(o,this.__wbg_ptr,e);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}decrement(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorocounter_decrement(o,this.__wbg_ptr,e);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get value(){return _.lorocounter_value(this.__wbg_ptr)}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorocounter_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}parent(){const e=_.lorocounter_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorocounter_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.lorocounter_getAttached(this.__wbg_ptr);return l(e)}getShallowValue(){return _.lorocounter_getShallowValue(this.__wbg_ptr)}}const Mt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorodoc_free(r>>>0));class B{static __wrap(e){e=e>>>0;const t=Object.create(B.prototype);return t.__wbg_ptr=e,Mt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Mt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorodoc_free(e)}constructor(){const e=_.lorodoc_new();return this.__wbg_ptr=e>>>0,this}setDetachedEditing(e){_.lorodoc_setDetachedEditing(this.__wbg_ptr,e)}isDetachedEditingEnabled(){return _.lorodoc_isDetachedEditingEnabled(this.__wbg_ptr)!==0}setRecordTimestamp(e){_.lorodoc_setRecordTimestamp(this.__wbg_ptr,e)}setChangeMergeInterval(e){_.lorodoc_setChangeMergeInterval(this.__wbg_ptr,e)}configTextStyle(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_configTextStyle(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}static fromSnapshot(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(e,_.__wbindgen_export_0),d=x;_.lorodoc_fromSnapshot(s,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return B.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}attach(){_.lorodoc_attach(this.__wbg_ptr)}isDetached(){return _.lorodoc_isDetached(this.__wbg_ptr)!==0}detach(){_.lorodoc_detach(this.__wbg_ptr)}fork(){const e=_.lorodoc_fork(this.__wbg_ptr);return B.__wrap(e)}forkAt(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=Z(e,_.__wbindgen_export_0),d=x;_.lorodoc_forkAt(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return B.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}checkoutToLatest(){try{const n=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_checkoutToLatest(n,this.__wbg_ptr);var e=a()[n/4+0],t=a()[n/4+1];if(t)throw l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}travelChangeAncestors(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=Z(e,_.__wbindgen_export_0),d=x;_.lorodoc_travelChangeAncestors(s,this.__wbg_ptr,i,d,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}findIdSpansBetween(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=Z(e,_.__wbindgen_export_0),p=x,g=Z(t,_.__wbindgen_export_0),m=x;_.lorodoc_findIdSpansBetween(i,this.__wbg_ptr,d,p,g,m);var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}checkout(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16),s=Z(e,_.__wbindgen_export_0),i=x;_.lorodoc_checkout(o,this.__wbg_ptr,s,i);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get peerId(){const e=_.lorodoc_peerId(this.__wbg_ptr);return BigInt.asUintN(64,e)}get peerIdStr(){const e=_.lorodoc_peerIdStr(this.__wbg_ptr);return l(e)}setPeerId(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_setPeerId(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}commit(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_commit(o,this.__wbg_ptr,j(e)?0:u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getPendingTxnLength(){return _.lorodoc_getPendingTxnLength(this.__wbg_ptr)>>>0}getText(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getText(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return Ke.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getMap(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getMap(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return Te.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getList(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getList(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return Xe.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getMovableList(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getMovableList(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return Ye.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getCounter(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getCounter(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return He.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getTree(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getTree(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return Ge.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getContainerById(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getContainerById(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}setNextCommitMessage(e){const t=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),n=x;_.lorodoc_setNextCommitMessage(this.__wbg_ptr,t,n)}getDeepValueWithID(){const e=_.lorodoc_getDeepValueWithID(this.__wbg_ptr);return l(e)}getPathToContainer(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getPathToContainer(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}JSONPath(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorodoc_JSONPath(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}version(){const e=_.lorodoc_version(this.__wbg_ptr);return F.__wrap(e)}shallowSinceVV(){const e=_.lorodoc_shallowSinceVV(this.__wbg_ptr);return F.__wrap(e)}isShallow(){return _.lorodoc_isShallow(this.__wbg_ptr)!==0}shallowSinceFrontiers(){const e=_.lorodoc_shallowSinceFrontiers(this.__wbg_ptr);return l(e)}oplogVersion(){const e=_.lorodoc_oplogVersion(this.__wbg_ptr);return F.__wrap(e)}frontiers(){const e=_.lorodoc_frontiers(this.__wbg_ptr);return l(e)}oplogFrontiers(){const e=_.lorodoc_oplogFrontiers(this.__wbg_ptr);return l(e)}cmpWithFrontiers(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=Z(e,_.__wbindgen_export_0),d=x;_.lorodoc_cmpWithFrontiers(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return t}finally{_.__wbindgen_add_to_stack_pointer(16)}}cmpFrontiers(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=Z(e,_.__wbindgen_export_0),p=x,g=Z(t,_.__wbindgen_export_0),m=x;_.lorodoc_cmpFrontiers(i,this.__wbg_ptr,d,p,g,m);var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}exportSnapshot(){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_exportSnapshot(i,this.__wbg_ptr);var e=a()[i/4+0],t=a()[i/4+1],n=a()[i/4+2],o=a()[i/4+3];if(o)throw l(n);var s=se(e,t).slice();return _.__wbindgen_export_5(e,t*1,1),s}finally{_.__wbindgen_add_to_stack_pointer(16)}}exportFrom(e){try{const d=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_exportFrom(d,this.__wbg_ptr,u(e));var t=a()[d/4+0],n=a()[d/4+1],o=a()[d/4+2],s=a()[d/4+3];if(s)throw l(o);var i=se(t,n).slice();return _.__wbindgen_export_5(t,n*1,1),i}finally{_.__wbindgen_add_to_stack_pointer(16)}}export(e){try{const d=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_export(d,this.__wbg_ptr,u(e));var t=a()[d/4+0],n=a()[d/4+1],o=a()[d/4+2],s=a()[d/4+3];if(s)throw l(o);var i=se(t,n).slice();return _.__wbindgen_export_5(t,n*1,1),i}finally{_.__wbindgen_add_to_stack_pointer(16)}}exportJsonUpdates(e,t,n){try{const d=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_exportJsonUpdates(d,this.__wbg_ptr,u(e),u(t),j(n)?0xffffff:n?1:0);var o=a()[d/4+0],s=a()[d/4+1],i=a()[d/4+2];if(i)throw l(s);return l(o)}finally{_.__wbindgen_add_to_stack_pointer(16)}}exportJsonInIdSpan(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_exportJsonInIdSpan(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}importJsonUpdates(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_importJsonUpdates(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}import(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(e,_.__wbindgen_export_0),d=x;_.lorodoc_import(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}importUpdateBatch(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_importUpdateBatch(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}importBatch(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_importBatch(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getShallowValue(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getShallowValue(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_toJSON(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}subscribe(e){const t=_.lorodoc_subscribe(this.__wbg_ptr,u(e));return l(t)}subscribeLocalUpdates(e){const t=_.lorodoc_subscribeLocalUpdates(this.__wbg_ptr,u(e));return l(t)}debugHistory(){_.lorodoc_debugHistory(this.__wbg_ptr)}changeCount(){return _.lorodoc_changeCount(this.__wbg_ptr)>>>0}opCount(){return _.lorodoc_opCount(this.__wbg_ptr)>>>0}getAllChanges(){const e=_.lorodoc_getAllChanges(this.__wbg_ptr);return l(e)}getChangeAt(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getChangeAt(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getChangeAtLamport(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),p=x;_.lorodoc_getChangeAtLamport(i,this.__wbg_ptr,d,p,t);var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getOpsInChange(e){try{const d=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getOpsInChange(d,this.__wbg_ptr,u(e));var t=a()[d/4+0],n=a()[d/4+1],o=a()[d/4+2],s=a()[d/4+3];if(s)throw l(o);var i=$(t,n).slice();return _.__wbindgen_export_5(t,n*4,4),i}finally{_.__wbindgen_add_to_stack_pointer(16)}}frontiersToVV(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=Z(e,_.__wbindgen_export_0),d=x;_.lorodoc_frontiersToVV(s,this.__wbg_ptr,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return F.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}vvToFrontiers(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);pe(e,F),_.lorodoc_vvToFrontiers(s,this.__wbg_ptr,e.__wbg_ptr);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getByPath(e){const t=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),n=x,o=_.lorodoc_getByPath(this.__wbg_ptr,t,n);return l(o)}getCursorPos(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);pe(e,te),_.lorodoc_getCursorPos(s,this.__wbg_ptr,e.__wbg_ptr);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getChangedContainersIn(e,t){try{const p=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_getChangedContainersIn(p,this.__wbg_ptr,u(e),t);var n=a()[p/4+0],o=a()[p/4+1],s=a()[p/4+2],i=a()[p/4+3];if(i)throw l(s);var d=$(n,o).slice();return _.__wbindgen_export_5(n,o*4,4),d}finally{_.__wbindgen_add_to_stack_pointer(16)}}revertTo(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16),s=Z(e,_.__wbindgen_export_0),i=x;_.lorodoc_revertTo(o,this.__wbg_ptr,s,i);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}applyDiff(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorodoc_applyDiff(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}diff(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=Z(e,_.__wbindgen_export_0),p=x,g=Z(t,_.__wbindgen_export_0),m=x;_.lorodoc_diff(i,this.__wbg_ptr,d,p,g,m);var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}}const Dt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorolist_free(r>>>0));class Xe{static __wrap(e){e=e>>>0;const t=Object.create(Xe.prototype);return t.__wbg_ptr=e,Dt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Dt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorolist_free(e)}constructor(){const e=_.lorolist_new();return this.__wbg_ptr=e>>>0,this}kind(){const e=_.lorolist_kind(this.__wbg_ptr);return l(e)}insert(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_insert(s,this.__wbg_ptr,e,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}delete(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_delete(s,this.__wbg_ptr,e,t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get(e){const t=_.lorolist_get(this.__wbg_ptr,e);return l(t)}get id(){const e=_.lorolist_id(this.__wbg_ptr);return l(e)}toArray(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_toArray(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){const e=_.lorolist_toJSON(this.__wbg_ptr);return l(e)}insertContainer(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_insertContainer(i,this.__wbg_ptr,e,u(t));var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}pushContainer(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_pushContainer(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get length(){return _.lorolist_length(this.__wbg_ptr)>>>0}parent(){const e=_.lorolist_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorolist_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.lorolist_getAttached(this.__wbg_ptr);return l(e)}getCursor(e,t){const n=_.lorolist_getCursor(this.__wbg_ptr,e,u(t));return n===0?void 0:te.__wrap(n)}push(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_push(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}pop(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_pop(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}clear(){try{const n=_.__wbindgen_add_to_stack_pointer(-16);_.lorolist_clear(n,this.__wbg_ptr);var e=a()[n/4+0],t=a()[n/4+1];if(t)throw l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getIdAt(e){const t=_.lorolist_getIdAt(this.__wbg_ptr,e);return l(t)}isDeleted(){return _.lorolist_isDeleted(this.__wbg_ptr)!==0}getShallowValue(){const e=_.lorolist_getShallowValue(this.__wbg_ptr);return l(e)}}const jt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_loromap_free(r>>>0));class Te{static __wrap(e){e=e>>>0;const t=Object.create(Te.prototype);return t.__wbg_ptr=e,jt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,jt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_loromap_free(e)}constructor(){const e=_.loromap_new();return this.__wbg_ptr=e>>>0,this}kind(){const e=_.loromap_kind(this.__wbg_ptr);return l(e)}set(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.loromap_set(s,this.__wbg_ptr,i,d,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}delete(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16),s=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),i=x;_.loromap_delete(o,this.__wbg_ptr,s,i);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get(e){const t=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),n=x,o=_.loromap_get(this.__wbg_ptr,t,n);return l(o)}getOrCreateContainer(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),p=x;_.loromap_getOrCreateContainer(i,this.__wbg_ptr,d,p,u(t));var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}keys(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromap_keys(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}values(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromap_values(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}entries(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromap_entries(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}get id(){const e=_.loromap_id(this.__wbg_ptr);return l(e)}toJSON(){const e=_.loromap_toJSON(this.__wbg_ptr);return l(e)}setContainer(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),p=x;_.loromap_setContainer(i,this.__wbg_ptr,d,p,u(t));var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromap_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get size(){return _.loromap_size(this.__wbg_ptr)>>>0}parent(){const e=_.loromap_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorocounter_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.loromap_getAttached(this.__wbg_ptr);return l(e)}clear(){try{const n=_.__wbindgen_add_to_stack_pointer(-16);_.loromap_clear(n,this.__wbg_ptr);var e=a()[n/4+0],t=a()[n/4+1];if(t)throw l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getLastEditor(e){const t=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),n=x,o=_.loromap_getLastEditor(this.__wbg_ptr,t,n);return l(o)}isDeleted(){return _.loromap_isDeleted(this.__wbg_ptr)!==0}getShallowValue(){const e=_.loromap_getShallowValue(this.__wbg_ptr);return l(e)}}const Lt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_loromovablelist_free(r>>>0));class Ye{static __wrap(e){e=e>>>0;const t=Object.create(Ye.prototype);return t.__wbg_ptr=e,Lt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Lt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_loromovablelist_free(e)}constructor(){const e=_.loromovablelist_new();return this.__wbg_ptr=e>>>0,this}kind(){const e=_.loromovablelist_kind(this.__wbg_ptr);return l(e)}insert(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_insert(s,this.__wbg_ptr,e,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}delete(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_delete(s,this.__wbg_ptr,e,t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get(e){const t=_.loromovablelist_get(this.__wbg_ptr,e);return l(t)}get id(){const e=_.loromovablelist_id(this.__wbg_ptr);return l(e)}toArray(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_toArray(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){const e=_.loromovablelist_toJSON(this.__wbg_ptr);return l(e)}insertContainer(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_insertContainer(i,this.__wbg_ptr,e,u(t));var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}pushContainer(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_pushContainer(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get length(){return _.loromovablelist_length(this.__wbg_ptr)>>>0}parent(){const e=_.loromap_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorocounter_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.loromovablelist_getAttached(this.__wbg_ptr);return l(e)}getCursor(e,t){const n=_.loromovablelist_getCursor(this.__wbg_ptr,e,u(t));return n===0?void 0:te.__wrap(n)}move(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_move(s,this.__wbg_ptr,e,t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}set(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_set(s,this.__wbg_ptr,e,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}setContainer(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_setContainer(i,this.__wbg_ptr,e,u(t));var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}push(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_push(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}pop(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_pop(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}clear(){try{const n=_.__wbindgen_add_to_stack_pointer(-16);_.loromovablelist_clear(n,this.__wbg_ptr);var e=a()[n/4+0],t=a()[n/4+1];if(t)throw l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getCreatorAt(e){const t=_.loromovablelist_getCreatorAt(this.__wbg_ptr,e);return l(t)}getLastMoverAt(e){const t=_.loromovablelist_getLastMoverAt(this.__wbg_ptr,e);return l(t)}getLastEditorAt(e){const t=_.loromovablelist_getLastEditorAt(this.__wbg_ptr,e);return l(t)}isDeleted(){return _.loromovablelist_isDeleted(this.__wbg_ptr)!==0}getShallowValue(){const e=_.loromovablelist_getShallowValue(this.__wbg_ptr);return l(e)}}const Ut=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorotext_free(r>>>0));class Ke{static __wrap(e){e=e>>>0;const t=Object.create(Ke.prototype);return t.__wbg_ptr=e,Ut.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ut.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorotext_free(e)}constructor(){const e=_.lorotext_new();return this.__wbg_ptr=e>>>0,this}kind(){const e=_.lorotext_kind(this.__wbg_ptr);return l(e)}iter(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_iter(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}update(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorotext_update(s,this.__wbg_ptr,i,d,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}updateByLine(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorotext_updateByLine(s,this.__wbg_ptr,i,d,u(t));var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}insert(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorotext_insert(s,this.__wbg_ptr,e,i,d);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}slice(e,t){let n,o;try{const E=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_slice(E,this.__wbg_ptr,e,t);var s=a()[E/4+0],i=a()[E/4+1],d=a()[E/4+2],p=a()[E/4+3],g=s,m=i;if(p)throw g=0,m=0,l(d);return n=g,o=m,N(g,m)}finally{_.__wbindgen_add_to_stack_pointer(16),_.__wbindgen_export_5(n,o,1)}}charAt(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_charAt(s,this.__wbg_ptr,e);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return String.fromCodePoint(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}splice(e,t,n){let o,s;try{const ne=_.__wbindgen_add_to_stack_pointer(-16),Ie=O(n,_.__wbindgen_export_0,_.__wbindgen_export_1),ko=x;_.lorotext_splice(ne,this.__wbg_ptr,e,t,Ie,ko);var i=a()[ne/4+0],d=a()[ne/4+1],p=a()[ne/4+2],g=a()[ne/4+3],m=i,E=d;if(g)throw m=0,E=0,l(p);return o=m,s=E,N(m,E)}finally{_.__wbindgen_add_to_stack_pointer(16),_.__wbindgen_export_5(o,s,1)}}insertUtf8(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorotext_insertUtf8(s,this.__wbg_ptr,e,i,d);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}delete(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_delete(s,this.__wbg_ptr,e,t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}deleteUtf8(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_deleteUtf8(s,this.__wbg_ptr,e,t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}mark(e,t,n){try{const i=_.__wbindgen_add_to_stack_pointer(-16),d=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),p=x;_.lorotext_mark(i,this.__wbg_ptr,u(e),d,p,u(n));var o=a()[i/4+0],s=a()[i/4+1];if(s)throw l(o)}finally{_.__wbindgen_add_to_stack_pointer(16)}}unmark(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),d=x;_.lorotext_unmark(s,this.__wbg_ptr,u(e),i,d);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16)}}toString(){let e,t;try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_toString(s,this.__wbg_ptr);var n=a()[s/4+0],o=a()[s/4+1];return e=n,t=o,N(n,o)}finally{_.__wbindgen_add_to_stack_pointer(16),_.__wbindgen_export_5(e,t,1)}}toDelta(){const e=_.lorotext_toDelta(this.__wbg_ptr);return l(e)}get id(){const e=_.lorotext_id(this.__wbg_ptr);return l(e)}get length(){return _.lorotext_length(this.__wbg_ptr)>>>0}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}applyDelta(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_applyDelta(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}parent(){const e=_.lorotext_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorocounter_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.lorotext_getAttached(this.__wbg_ptr);return l(e)}getCursor(e,t){const n=_.lorotext_getCursor(this.__wbg_ptr,e,u(t));return n===0?void 0:te.__wrap(n)}push(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16),s=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),i=x;_.lorotext_push(o,this.__wbg_ptr,s,i);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getEditorOf(e){const t=_.lorotext_getEditorOf(this.__wbg_ptr,e);return l(t)}isDeleted(){return _.lorotext_isDeleted(this.__wbg_ptr)!==0}getShallowValue(){let e,t;try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotext_getShallowValue(s,this.__wbg_ptr);var n=a()[s/4+0],o=a()[s/4+1];return e=n,t=o,N(n,o)}finally{_.__wbindgen_add_to_stack_pointer(16),_.__wbindgen_export_5(e,t,1)}}}const Zt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorotree_free(r>>>0));class Ge{static __wrap(e){e=e>>>0;const t=Object.create(Ge.prototype);return t.__wbg_ptr=e,Zt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Zt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorotree_free(e)}constructor(){const e=_.lorotree_new();return this.__wbg_ptr=e>>>0,this}kind(){const e=_.lorotree_kind(this.__wbg_ptr);return l(e)}createNode(e,t){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_createNode(i,this.__wbg_ptr,U(e),!j(t),j(t)?0:t);var n=a()[i/4+0],o=a()[i/4+1],s=a()[i/4+2];if(s)throw l(o);return H.__wrap(n)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}move(e,t,n){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_move(i,this.__wbg_ptr,U(e),U(t),!j(n),j(n)?0:n);var o=a()[i/4+0],s=a()[i/4+1];if(s)throw l(o)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0,T[R++]=void 0}}delete(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_delete(o,this.__wbg_ptr,U(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}getNodeByID(e){try{const t=_.lorotree_getNodeByID(this.__wbg_ptr,U(e));return t===0?void 0:H.__wrap(t)}finally{T[R++]=void 0}}get id(){const e=_.lorotree_id(this.__wbg_ptr);return l(e)}has(e){try{return _.lorotree_has(this.__wbg_ptr,U(e))!==0}finally{T[R++]=void 0}}isNodeDeleted(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_isNodeDeleted(s,this.__wbg_ptr,U(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return t!==0}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}toArray(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_toArray(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}getNodes(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_getNodes(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){const e=_.lorotree_toJSON(this.__wbg_ptr);return l(e)}nodes(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_nodes(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}roots(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_roots(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=$(e,t).slice();return _.__wbindgen_export_5(e,t*4,4),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}subscribe(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotree_subscribe(s,this.__wbg_ptr,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}parent(){const e=_.lorotree_parent(this.__wbg_ptr);return l(e)}isAttached(){return _.lorotree_isAttached(this.__wbg_ptr)!==0}getAttached(){const e=_.lorotree_getAttached(this.__wbg_ptr);return l(e)}enableFractionalIndex(e){_.lorotree_enableFractionalIndex(this.__wbg_ptr,e)}disableFractionalIndex(){_.lorotree_disableFractionalIndex(this.__wbg_ptr)}isFractionalIndexEnabled(){return _.lorotree_isFractionalIndexEnabled(this.__wbg_ptr)!==0}isDeleted(){return _.lorotree_isDeleted(this.__wbg_ptr)!==0}getShallowValue(){const e=_.lorotree_getShallowValue(this.__wbg_ptr);return l(e)}}const Ft=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_lorotreenode_free(r>>>0));class H{static __wrap(e){e=e>>>0;const t=Object.create(H.prototype);return t.__wbg_ptr=e,Ft.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ft.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_lorotreenode_free(e)}__getClassname(){let e,t;try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode___getClassname(s,this.__wbg_ptr);var n=a()[s/4+0],o=a()[s/4+1];return e=n,t=o,N(n,o)}finally{_.__wbindgen_add_to_stack_pointer(16),_.__wbindgen_export_5(e,t,1)}}get id(){const e=_.lorotreenode_id(this.__wbg_ptr);return l(e)}createNode(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_createNode(s,this.__wbg_ptr,!j(e),j(e)?0:e);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return H.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}move(e,t){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_move(s,this.__wbg_ptr,U(e),!j(t),j(t)?0:t);var n=a()[s/4+0],o=a()[s/4+1];if(o)throw l(n)}finally{_.__wbindgen_add_to_stack_pointer(16),T[R++]=void 0}}moveAfter(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);pe(e,H),_.lorotreenode_moveAfter(o,this.__wbg_ptr,e.__wbg_ptr);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}moveBefore(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);pe(e,H),_.lorotreenode_moveBefore(o,this.__wbg_ptr,e.__wbg_ptr);var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}index(){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_index(s,this.__wbg_ptr);var e=a()[s/4+0],t=a()[s/4+1],n=a()[s/4+2],o=a()[s/4+3];if(o)throw l(n);return e===0?void 0:t>>>0}finally{_.__wbindgen_add_to_stack_pointer(16)}}fractionalIndex(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_fractionalIndex(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get data(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_data(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return Te.__wrap(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_toJSON(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return l(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}parent(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_parent(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return e===0?void 0:H.__wrap(e)}finally{_.__wbindgen_add_to_stack_pointer(16)}}children(){const e=_.lorotreenode_children(this.__wbg_ptr);return l(e)}isDeleted(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.lorotreenode_isDeleted(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return e!==0}finally{_.__wbindgen_add_to_stack_pointer(16)}}getLastMoveId(){const e=_.lorotreenode_getLastMoveId(this.__wbg_ptr);return l(e)}creationId(){const e=_.lorotreenode_creationId(this.__wbg_ptr);return l(e)}creator(){const e=_.lorotreenode_creator(this.__wbg_ptr);return l(e)}}const Po=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_undomanager_free(r>>>0));class Bo{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Po.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_undomanager_free(e)}constructor(e,t){pe(e,B);const n=_.undomanager_new(e.__wbg_ptr,u(t));return this.__wbg_ptr=n>>>0,this}undo(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.undomanager_undo(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return e!==0}finally{_.__wbindgen_add_to_stack_pointer(16)}}redo(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.undomanager_redo(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=a()[o/4+2];if(n)throw l(t);return e!==0}finally{_.__wbindgen_add_to_stack_pointer(16)}}canUndo(){return _.undomanager_canUndo(this.__wbg_ptr)!==0}canRedo(){return _.undomanager_canRedo(this.__wbg_ptr)!==0}setMaxUndoSteps(e){_.undomanager_setMaxUndoSteps(this.__wbg_ptr,e)}setMergeInterval(e){_.undomanager_setMergeInterval(this.__wbg_ptr,e)}addExcludeOriginPrefix(e){const t=O(e,_.__wbindgen_export_0,_.__wbindgen_export_1),n=x;_.undomanager_addExcludeOriginPrefix(this.__wbg_ptr,t,n)}checkBinding(e){return pe(e,B),_.undomanager_checkBinding(this.__wbg_ptr,e.__wbg_ptr)!==0}setOnPush(e){_.undomanager_setOnPush(this.__wbg_ptr,u(e))}setOnPop(e){_.undomanager_setOnPop(this.__wbg_ptr,u(e))}clear(){_.undomanager_clear(this.__wbg_ptr)}}const Vt=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>_.__wbg_versionvector_free(r>>>0));class F{static __wrap(e){e=e>>>0;const t=Object.create(F.prototype);return t.__wbg_ptr=e,Vt.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Vt.unregister(this),e}free(){const e=this.__destroy_into_raw();_.__wbg_versionvector_free(e)}constructor(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_new(s,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return this.__wbg_ptr=t>>>0,this}finally{_.__wbindgen_add_to_stack_pointer(16)}}static parseJSON(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_parseJSON(s,u(e));var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return F.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}toJSON(){const e=_.versionvector_toJSON(this.__wbg_ptr);return l(e)}encode(){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_encode(o,this.__wbg_ptr);var e=a()[o/4+0],t=a()[o/4+1],n=se(e,t).slice();return _.__wbindgen_export_5(e,t*1,1),n}finally{_.__wbindgen_add_to_stack_pointer(16)}}static decode(e){try{const s=_.__wbindgen_add_to_stack_pointer(-16),i=ue(e,_.__wbindgen_export_0),d=x;_.versionvector_decode(s,i,d);var t=a()[s/4+0],n=a()[s/4+1],o=a()[s/4+2];if(o)throw l(n);return F.__wrap(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}get(e){try{const i=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_get(i,this.__wbg_ptr,u(e));var t=a()[i/4+0],n=a()[i/4+1],o=a()[i/4+2],s=a()[i/4+3];if(s)throw l(o);return t===0?void 0:n}finally{_.__wbindgen_add_to_stack_pointer(16)}}compare(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);pe(e,F),_.versionvector_compare(o,this.__wbg_ptr,e.__wbg_ptr);var t=a()[o/4+0],n=a()[o/4+1];return t===0?void 0:n}finally{_.__wbindgen_add_to_stack_pointer(16)}}setEnd(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_setEnd(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}setLast(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_setLast(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}remove(e){try{const o=_.__wbindgen_add_to_stack_pointer(-16);_.versionvector_remove(o,this.__wbg_ptr,u(e));var t=a()[o/4+0],n=a()[o/4+1];if(n)throw l(t)}finally{_.__wbindgen_add_to_stack_pointer(16)}}length(){return _.versionvector_length(this.__wbg_ptr)>>>0}}function er(r){l(r)}function tr(r){const e=Xe.__wrap(r);return u(e)}function rr(r){const e=He.__wrap(r);return u(e)}function nr(r){const e=Te.__wrap(r);return u(e)}function or(r){const e=H.__wrap(r);return u(e)}function sr(r){const e=Ge.__wrap(r);return u(e)}function _r(r){const e=Ye.__wrap(r);return u(e)}function ar(r){const e=te.__wrap(r);return u(e)}function ir(r){const e=Ke.__wrap(r);return u(e)}function cr(r){const e=F.__wrap(r);return u(e)}function dr(r){return typeof h(r)=="function"}function lr(r,e){const t=N(r,e);return u(t)}function ur(r){const e=h(r);return typeof e=="boolean"?e?1:0:2}function pr(r,e){const t=new Error(N(r,e));return u(t)}function gr(r){const e=h(r);return u(e)}function fr(r,e){const t=h(e),n=typeof t=="string"?t:void 0;var o=j(n)?0:O(n,_.__wbindgen_export_0,_.__wbindgen_export_1),s=x;a()[r/4+1]=s,a()[r/4+0]=o}function hr(r){return h(r)===void 0}function br(r,e){return h(r)in h(e)}function wr(r){return typeof h(r)=="bigint"}function mr(r,e){const t=h(e),n=typeof t=="number"?t:void 0;Kt()[r/8+1]=j(n)?0:n,a()[r/4+0]=!j(n)}function yr(r){return u(r)}function vr(r,e){return h(r)===h(e)}function kr(r){const e=h(r);return typeof e=="object"&&e!==null}function xr(r){const e=BigInt.asUintN(64,r);return u(e)}function Sr(r){const e=l(r).original;return e.cnt--==1?(e.a=0,!0):!1}function Ar(r){return+h(r)}function Cr(r){return typeof h(r)=="string"}function Tr(r){return h(r)===null}function Ir(r){return u(r)}function Or(r){return Array.isArray(h(r))}function Er(r){const e=typeof h(r);return u(e)}function Nr(r,e){console.error(N(r,e))}function Rr(r,e){console.log(N(r,e))}function Mr(r){return!h(r)}function Dr(r,e){return h(r)==h(e)}function jr(r,e){const t=String(h(e)),n=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),o=x;a()[r/4+1]=o,a()[r/4+0]=n}function Lr(r,e){const t=h(r)[h(e)];return u(t)}function Ur(r,e,t){h(r)[l(e)]=l(t)}function Zr(r,e){let t,n;try{t=r,n=e,console.log(N(r,e))}finally{_.__wbindgen_export_5(t,n,1)}}function Fr(r,e,t,n,o,s,i,d){let p,g;try{p=r,g=e,console.log(N(r,e),N(t,n),N(o,s),N(i,d))}finally{_.__wbindgen_export_5(p,g,1)}}function Vr(r,e){performance.mark(N(r,e))}function Pr(){return M(function(r,e,t,n){let o,s,i,d;try{o=r,s=e,i=t,d=n,performance.measure(N(r,e),N(t,n))}finally{_.__wbindgen_export_5(o,s,1),_.__wbindgen_export_5(i,d,1)}},arguments)}function Br(){const r=new Error;return u(r)}function zr(r,e){const t=h(e).stack,n=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),o=x;a()[r/4+1]=o,a()[r/4+0]=n}function $r(r,e){let t,n;try{t=r,n=e,console.error(N(r,e))}finally{_.__wbindgen_export_5(t,n,1)}}const Jr=typeof Date.now=="function"?Date.now:Zo("Date.now");function Wr(r){const e=h(r).crypto;return u(e)}function qr(r){const e=h(r).process;return u(e)}function Hr(r){const e=h(r).versions;return u(e)}function Xr(r){const e=h(r).node;return u(e)}function Yr(){return M(function(){const r=module.require;return u(r)},arguments)}function Kr(r){const e=h(r).msCrypto;return u(e)}function Gr(){return M(function(r,e){h(r).getRandomValues(h(e))},arguments)}function Qr(){return M(function(r,e){h(r).randomFillSync(l(e))},arguments)}function en(){return M(function(){const r=self.self;return u(r)},arguments)}function tn(){return M(function(){const r=window.window;return u(r)},arguments)}function rn(){return M(function(){const r=globalThis.globalThis;return u(r)},arguments)}function nn(){return M(function(){const r=global.global;return u(r)},arguments)}function on(r,e){const t=new Function(N(r,e));return u(t)}function sn(){return M(function(r,e){const t=h(r).call(h(e));return u(t)},arguments)}function _n(r,e){const t=h(r)[e>>>0];return u(t)}function an(r){return h(r).length}function cn(){const r=new Array;return u(r)}function dn(){return u(new Map)}function ln(r){const e=h(r).next;return u(e)}function un(){return M(function(r){const e=h(r).next();return u(e)},arguments)}function pn(r){return h(r).done}function gn(r){const e=h(r).value;return u(e)}function fn(){return u(Symbol.iterator)}function hn(){return M(function(r,e){const t=Reflect.get(h(r),h(e));return u(t)},arguments)}function bn(){const r=new Object;return u(r)}function wn(r){const e=new Array(r>>>0);return u(e)}function mn(r,e,t){h(r)[e>>>0]=l(t)}function yn(r){const e=Array.from(h(r));return u(e)}function vn(r){return Array.isArray(h(r))}function kn(r,e){return h(r).push(h(e))}function xn(r){let e;try{e=h(r)instanceof ArrayBuffer}catch{e=!1}return e}function Sn(){return M(function(r,e,t){const n=h(r).call(h(e),h(t));return u(n)},arguments)}function An(){return M(function(r,e,t,n){const o=h(r).call(h(e),h(t),h(n));return u(o)},arguments)}function Cn(){return M(function(r,e,t,n,o){const s=h(r).call(h(e),h(t),h(n),h(o));return u(s)},arguments)}function Tn(r){let e;try{e=h(r)instanceof Map}catch{e=!1}return e}function In(r,e,t){const n=h(r).set(h(e),h(t));return u(n)}function On(r){const e=h(r).entries();return u(e)}function En(r){return Number.isSafeInteger(h(r))}function Nn(r){let e;try{e=h(r)instanceof Object}catch{e=!1}return e}function Rn(r){const e=Object.entries(h(r));return u(e)}function Mn(){return M(function(r,e,t){const n=Reflect.apply(h(r),h(e),h(t));return u(n)},arguments)}function Dn(){return M(function(r){const e=Reflect.ownKeys(h(r));return u(e)},arguments)}function jn(){return M(function(r,e,t){return Reflect.set(h(r),h(e),h(t))},arguments)}function Ln(r){const e=h(r).buffer;return u(e)}function Un(r){const e=Promise.resolve(h(r));return u(e)}function Zn(r,e){const t=h(r).then(h(e));return u(t)}function Fn(r,e,t){const n=new Uint8Array(h(r),e>>>0,t>>>0);return u(n)}function Vn(r){const e=new Uint8Array(h(r));return u(e)}function Pn(r,e,t){h(r).set(h(e),t>>>0)}function Bn(r){return h(r).length}function zn(r){let e;try{e=h(r)instanceof Uint8Array}catch{e=!1}return e}function $n(r){const e=new Uint8Array(r>>>0);return u(e)}function Jn(r,e,t){const n=h(r).subarray(e>>>0,t>>>0);return u(n)}function Wn(r,e){return h(r)[e>>>0]}function qn(r,e,t){h(r)[e>>>0]=t}function Hn(r,e){const t=h(e),n=typeof t=="bigint"?t:void 0;Eo()[r/8+1]=j(n)?BigInt(0):n,a()[r/4+0]=!j(n)}function Xn(r,e){const t=mt(h(e)),n=O(t,_.__wbindgen_export_0,_.__wbindgen_export_1),o=x;a()[r/4+1]=o,a()[r/4+0]=n}function Yn(r,e){throw new Error(N(r,e))}function Kn(r){throw l(r)}function Gn(){const r=_.memory;return u(r)}function Qn(r,e,t){const n=Gt(r,e,9,No);return u(n)}function eo(r,e,t){const n=Gt(r,e,11,Ro);return u(n)}var zo=Object.freeze({__proto__:null,AwarenessWasm:Vo,Cursor:te,LoroCounter:He,LoroDoc:B,LoroList:Xe,LoroMap:Te,LoroMovableList:Ye,LoroText:Ke,LoroTree:Ge,LoroTreeNode:H,UndoManager:Bo,VersionVector:F,__wbg_String_b9412f8799faab3e:jr,__wbg_apply_0a5aa603881e6d79:Mn,__wbg_buffer_12d079cc21e14bdb:Ln,__wbg_call_27c0f87801dedf93:sn,__wbg_call_8e7cb608789c2528:An,__wbg_call_938992c832f74314:Cn,__wbg_call_b3ca7c6051f9bec1:Sn,__wbg_crypto_1d1f22824a6a080c:Wr,__wbg_cursor_new:ar,__wbg_done_298b57d23c0fc80c:pn,__wbg_entries_95cc2c823b285a09:Rn,__wbg_entries_ce844941d0c51880:On,__wbg_error_c8c2cca30a630316:Nr,__wbg_error_f851667af71bcfc6:$r,__wbg_from_89e3fc3ba5e6fb48:yn,__wbg_getRandomValues_3aa56aa6edec874c:Gr,__wbg_get_bd8e338fbd5f5cc8:_n,__wbg_get_e3c254076557e348:hn,__wbg_getindex_03d06b4e7ea3475e:Wn,__wbg_getwithrefkey_edc2c8960f0f1191:Lr,__wbg_globalThis_d1e6af4856ba331b:rn,__wbg_global_207b558942527489:nn,__wbg_instanceof_ArrayBuffer_836825be07d4c9d2:xn,__wbg_instanceof_Map_87917e0a7aaf4012:Tn,__wbg_instanceof_Object_71ca3c0a59266746:Nn,__wbg_instanceof_Uint8Array_2b3bbecd033d19f6:zn,__wbg_isArray_2ab64d95e09ea0ae:vn,__wbg_isSafeInteger_f7b04ef02296c4d2:En,__wbg_iterator_2cee6dadfd956dfa:fn,__wbg_length_c20a40f15020d68a:Bn,__wbg_length_cd7af8117672b8b8:an,__wbg_log_aba5996d9bde071f:Fr,__wbg_log_c9486ca5d8e2cbe8:Zr,__wbg_log_d8fdbde28117925d:Rr,__wbg_lorocounter_new:rr,__wbg_lorolist_new:tr,__wbg_loromap_new:nr,__wbg_loromovablelist_new:_r,__wbg_lorotext_new:ir,__wbg_lorotree_new:sr,__wbg_lorotreenode_new:or,__wbg_mark_40e050a77cc39fea:Vr,__wbg_measure_aa7a73f17813f708:Pr,__wbg_msCrypto_eb05e62b530a1508:Kr,__wbg_new_16b304a2cfa7ff4a:cn,__wbg_new_63b92bc8671ed464:Vn,__wbg_new_72fb9a18b5ae2624:bn,__wbg_new_abda76e883ba8a5f:Br,__wbg_new_d9bc3a0147634640:dn,__wbg_newnoargs_e258087cd0daa0ea:on,__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb:Fn,__wbg_newwithlength_66ae46612e7f0234:wn,__wbg_newwithlength_e9b4878cebadb3d3:$n,__wbg_next_196c84450b364254:un,__wbg_next_40fc327bfc8770e6:ln,__wbg_node_104a2ff8d6ea03a2:Xr,__wbg_now_15d99db1ebc1f0b2:Jr,__wbg_ownKeys_658942b7f28d1fe9:Dn,__wbg_process_4a72847cc503995b:qr,__wbg_push_a5b05aedc7234f9f:kn,__wbg_randomFillSync_5c9c955aa56b6049:Qr,__wbg_require_cca90b1a94a0255b:Yr,__wbg_resolve_b0083a7967828ec8:Un,__wbg_self_ce0dbfc45cf2f5be:en,__wbg_set_1f9b04f170055d33:jn,__wbg_set_8417257aaedc936b:In,__wbg_set_a47bac70306a19a7:Pn,__wbg_set_d4638f722068f043:mn,__wbg_set_f975102236d3c502:Ur,__wbg_set_wasm:wt,__wbg_setindex_0b7ede192dc5eca8:qn,__wbg_stack_658279fe44541cf6:zr,__wbg_subarray_a1f73cd4b5b42fe1:Jn,__wbg_then_0c86a60e8fcfe9f6:Zn,__wbg_value_d93c65011f51a456:gn,__wbg_versions_f686565e586dd935:Hr,__wbg_versionvector_new:cr,__wbg_window_c6fb939a7f436783:tn,__wbindgen_as_number:Ar,__wbindgen_bigint_from_i64:yr,__wbindgen_bigint_from_u64:xr,__wbindgen_bigint_get_as_i64:Hn,__wbindgen_boolean_get:ur,__wbindgen_cb_drop:Sr,__wbindgen_closure_wrapper491:Qn,__wbindgen_closure_wrapper494:eo,__wbindgen_debug_string:Xn,__wbindgen_error_new:pr,__wbindgen_in:br,__wbindgen_is_array:Or,__wbindgen_is_bigint:wr,__wbindgen_is_falsy:Mr,__wbindgen_is_function:dr,__wbindgen_is_null:Tr,__wbindgen_is_object:kr,__wbindgen_is_string:Cr,__wbindgen_is_undefined:hr,__wbindgen_jsval_eq:vr,__wbindgen_jsval_loose_eq:Dr,__wbindgen_memory:Gn,__wbindgen_number_get:mr,__wbindgen_number_new:Ir,__wbindgen_object_clone_ref:gr,__wbindgen_object_drop_ref:er,__wbindgen_rethrow:Kn,__wbindgen_string_get:fr,__wbindgen_string_new:lr,__wbindgen_throw:Yn,__wbindgen_typeof:Er,decodeFrontiers:jo,decodeImportBlobMeta:Uo,encodeFrontiers:Do,run:Mo,setDebug:Lo});URL=globalThis.URL;const c=await Ao({"./loro_wasm_bg.js":{__wbindgen_object_drop_ref:er,__wbg_lorolist_new:tr,__wbg_lorocounter_new:rr,__wbg_loromap_new:nr,__wbg_lorotreenode_new:or,__wbg_lorotree_new:sr,__wbg_loromovablelist_new:_r,__wbg_cursor_new:ar,__wbg_lorotext_new:ir,__wbg_versionvector_new:cr,__wbindgen_is_function:dr,__wbindgen_string_new:lr,__wbindgen_boolean_get:ur,__wbindgen_error_new:pr,__wbindgen_object_clone_ref:gr,__wbindgen_string_get:fr,__wbindgen_is_undefined:hr,__wbindgen_in:br,__wbindgen_is_bigint:wr,__wbindgen_number_get:mr,__wbindgen_bigint_from_i64:yr,__wbindgen_jsval_eq:vr,__wbindgen_is_object:kr,__wbindgen_bigint_from_u64:xr,__wbindgen_cb_drop:Sr,__wbindgen_as_number:Ar,__wbindgen_is_string:Cr,__wbindgen_is_null:Tr,__wbindgen_number_new:Ir,__wbindgen_is_array:Or,__wbindgen_typeof:Er,__wbg_error_c8c2cca30a630316:Nr,__wbg_log_d8fdbde28117925d:Rr,__wbindgen_is_falsy:Mr,__wbindgen_jsval_loose_eq:Dr,__wbg_String_b9412f8799faab3e:jr,__wbg_getwithrefkey_edc2c8960f0f1191:Lr,__wbg_set_f975102236d3c502:Ur,__wbg_log_c9486ca5d8e2cbe8:Zr,__wbg_log_aba5996d9bde071f:Fr,__wbg_mark_40e050a77cc39fea:Vr,__wbg_measure_aa7a73f17813f708:Pr,__wbg_new_abda76e883ba8a5f:Br,__wbg_stack_658279fe44541cf6:zr,__wbg_error_f851667af71bcfc6:$r,__wbg_now_15d99db1ebc1f0b2:Jr,__wbg_crypto_1d1f22824a6a080c:Wr,__wbg_process_4a72847cc503995b:qr,__wbg_versions_f686565e586dd935:Hr,__wbg_node_104a2ff8d6ea03a2:Xr,__wbg_require_cca90b1a94a0255b:Yr,__wbg_msCrypto_eb05e62b530a1508:Kr,__wbg_getRandomValues_3aa56aa6edec874c:Gr,__wbg_randomFillSync_5c9c955aa56b6049:Qr,__wbg_self_ce0dbfc45cf2f5be:en,__wbg_window_c6fb939a7f436783:tn,__wbg_globalThis_d1e6af4856ba331b:rn,__wbg_global_207b558942527489:nn,__wbg_newnoargs_e258087cd0daa0ea:on,__wbg_call_27c0f87801dedf93:sn,__wbg_get_bd8e338fbd5f5cc8:_n,__wbg_length_cd7af8117672b8b8:an,__wbg_new_16b304a2cfa7ff4a:cn,__wbg_new_d9bc3a0147634640:dn,__wbg_next_40fc327bfc8770e6:ln,__wbg_next_196c84450b364254:un,__wbg_done_298b57d23c0fc80c:pn,__wbg_value_d93c65011f51a456:gn,__wbg_iterator_2cee6dadfd956dfa:fn,__wbg_get_e3c254076557e348:hn,__wbg_new_72fb9a18b5ae2624:bn,__wbg_newwithlength_66ae46612e7f0234:wn,__wbg_set_d4638f722068f043:mn,__wbg_from_89e3fc3ba5e6fb48:yn,__wbg_isArray_2ab64d95e09ea0ae:vn,__wbg_push_a5b05aedc7234f9f:kn,__wbg_instanceof_ArrayBuffer_836825be07d4c9d2:xn,__wbg_call_b3ca7c6051f9bec1:Sn,__wbg_call_8e7cb608789c2528:An,__wbg_call_938992c832f74314:Cn,__wbg_instanceof_Map_87917e0a7aaf4012:Tn,__wbg_set_8417257aaedc936b:In,__wbg_entries_ce844941d0c51880:On,__wbg_isSafeInteger_f7b04ef02296c4d2:En,__wbg_instanceof_Object_71ca3c0a59266746:Nn,__wbg_entries_95cc2c823b285a09:Rn,__wbg_apply_0a5aa603881e6d79:Mn,__wbg_ownKeys_658942b7f28d1fe9:Dn,__wbg_set_1f9b04f170055d33:jn,__wbg_buffer_12d079cc21e14bdb:Ln,__wbg_resolve_b0083a7967828ec8:Un,__wbg_then_0c86a60e8fcfe9f6:Zn,__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb:Fn,__wbg_new_63b92bc8671ed464:Vn,__wbg_set_a47bac70306a19a7:Pn,__wbg_length_c20a40f15020d68a:Bn,__wbg_instanceof_Uint8Array_2b3bbecd033d19f6:zn,__wbg_newwithlength_e9b4878cebadb3d3:$n,__wbg_subarray_a1f73cd4b5b42fe1:Jn,__wbg_getindex_03d06b4e7ea3475e:Wn,__wbg_setindex_0b7ede192dc5eca8:qn,__wbindgen_bigint_get_as_i64:Hn,__wbindgen_debug_string:Xn,__wbindgen_throw:Yn,__wbindgen_rethrow:Kn,__wbindgen_memory:Gn,__wbindgen_closure_wrapper491:Qn,__wbindgen_closure_wrapper494:eo}},So),$o=c.memory,Jo=c.__wbg_lorocounter_free,Wo=c.lorocounter_new,qo=c.lorocounter_increment,Ho=c.lorocounter_decrement,Xo=c.lorocounter_value,Yo=c.lorocounter_subscribe,Ko=c.lorocounter_parent,Go=c.lorocounter_isAttached,Qo=c.lorocounter_getAttached,es=c.lorocounter_getShallowValue,ts=c.__wbg_awarenesswasm_free,rs=c.awarenesswasm_new,ns=c.awarenesswasm_encode,os=c.awarenesswasm_encodeAll,ss=c.awarenesswasm_apply,_s=c.awarenesswasm_setLocalState,as=c.awarenesswasm_peer,is=c.awarenesswasm_getAllStates,cs=c.awarenesswasm_getState,ds=c.awarenesswasm_getTimestamp,ls=c.awarenesswasm_removeOutdated,us=c.awarenesswasm_length,ps=c.awarenesswasm_isEmpty,gs=c.awarenesswasm_peers,fs=c.run,hs=c.encodeFrontiers,bs=c.decodeFrontiers,ws=c.setDebug,ms=c.__wbg_lorodoc_free,ys=c.lorodoc_new,vs=c.lorodoc_setDetachedEditing,ks=c.lorodoc_isDetachedEditingEnabled,xs=c.lorodoc_setRecordTimestamp,Ss=c.lorodoc_setChangeMergeInterval,As=c.lorodoc_configTextStyle,Cs=c.lorodoc_fromSnapshot,Ts=c.lorodoc_attach,Is=c.lorodoc_isDetached,Os=c.lorodoc_detach,Es=c.lorodoc_fork,Ns=c.lorodoc_forkAt,Rs=c.lorodoc_checkoutToLatest,Ms=c.lorodoc_travelChangeAncestors,Ds=c.lorodoc_findIdSpansBetween,js=c.lorodoc_checkout,Ls=c.lorodoc_peerId,Us=c.lorodoc_peerIdStr,Zs=c.lorodoc_setPeerId,Fs=c.lorodoc_commit,Vs=c.lorodoc_getPendingTxnLength,Ps=c.lorodoc_getText,Bs=c.lorodoc_getMap,zs=c.lorodoc_getList,$s=c.lorodoc_getMovableList,Js=c.lorodoc_getCounter,Ws=c.lorodoc_getTree,qs=c.lorodoc_getContainerById,Hs=c.lorodoc_setNextCommitMessage,Xs=c.lorodoc_getDeepValueWithID,Ys=c.lorodoc_getPathToContainer,Ks=c.lorodoc_JSONPath,Gs=c.lorodoc_version,Qs=c.lorodoc_shallowSinceVV,e_=c.lorodoc_isShallow,t_=c.lorodoc_shallowSinceFrontiers,r_=c.lorodoc_oplogVersion,n_=c.lorodoc_frontiers,o_=c.lorodoc_oplogFrontiers,s_=c.lorodoc_cmpWithFrontiers,__=c.lorodoc_cmpFrontiers,a_=c.lorodoc_exportSnapshot,i_=c.lorodoc_exportFrom,c_=c.lorodoc_export,d_=c.lorodoc_exportJsonUpdates,l_=c.lorodoc_exportJsonInIdSpan,u_=c.lorodoc_importJsonUpdates,p_=c.lorodoc_import,g_=c.lorodoc_importUpdateBatch,f_=c.lorodoc_importBatch,h_=c.lorodoc_getShallowValue,b_=c.lorodoc_toJSON,w_=c.lorodoc_subscribe,m_=c.lorodoc_subscribeLocalUpdates,y_=c.lorodoc_debugHistory,v_=c.lorodoc_changeCount,k_=c.lorodoc_opCount,x_=c.lorodoc_getAllChanges,S_=c.lorodoc_getChangeAt,A_=c.lorodoc_getChangeAtLamport,C_=c.lorodoc_getOpsInChange,T_=c.lorodoc_frontiersToVV,I_=c.lorodoc_vvToFrontiers,O_=c.lorodoc_getByPath,E_=c.lorodoc_getCursorPos,N_=c.lorodoc_getChangedContainersIn,R_=c.lorodoc_revertTo,M_=c.lorodoc_applyDiff,D_=c.lorodoc_diff,j_=c.__wbg_lorotext_free,L_=c.lorotext_new,U_=c.lorotext_kind,Z_=c.lorotext_iter,F_=c.lorotext_update,V_=c.lorotext_updateByLine,P_=c.lorotext_insert,B_=c.lorotext_slice,z_=c.lorotext_charAt,$_=c.lorotext_splice,J_=c.lorotext_insertUtf8,W_=c.lorotext_delete,q_=c.lorotext_deleteUtf8,H_=c.lorotext_mark,X_=c.lorotext_unmark,Y_=c.lorotext_toString,K_=c.lorotext_toDelta,G_=c.lorotext_id,Q_=c.lorotext_length,ea=c.lorotext_subscribe,ta=c.lorotext_applyDelta,ra=c.lorotext_parent,na=c.lorotext_getAttached,oa=c.lorotext_getCursor,sa=c.lorotext_push,_a=c.lorotext_getEditorOf,aa=c.lorotext_isDeleted,ia=c.lorotext_getShallowValue,ca=c.__wbg_loromap_free,da=c.loromap_new,la=c.loromap_kind,ua=c.loromap_set,pa=c.loromap_delete,ga=c.loromap_get,fa=c.loromap_getOrCreateContainer,ha=c.loromap_keys,ba=c.loromap_values,wa=c.loromap_entries,ma=c.loromap_id,ya=c.loromap_toJSON,va=c.loromap_setContainer,ka=c.loromap_subscribe,xa=c.loromap_size,Sa=c.loromap_parent,Aa=c.loromap_getAttached,Ca=c.loromap_clear,Ta=c.loromap_getLastEditor,Ia=c.loromap_isDeleted,Oa=c.loromap_getShallowValue,Ea=c.__wbg_lorolist_free,Na=c.lorolist_new,Ra=c.lorolist_kind,Ma=c.lorolist_insert,Da=c.lorolist_delete,ja=c.lorolist_get,La=c.lorolist_id,Ua=c.lorolist_toArray,Za=c.lorolist_toJSON,Fa=c.lorolist_insertContainer,Va=c.lorolist_pushContainer,Pa=c.lorolist_subscribe,Ba=c.lorolist_length,za=c.lorolist_parent,$a=c.lorolist_isAttached,Ja=c.lorolist_getAttached,Wa=c.lorolist_getCursor,qa=c.lorolist_push,Ha=c.lorolist_pop,Xa=c.lorolist_clear,Ya=c.lorolist_getIdAt,Ka=c.lorolist_isDeleted,Ga=c.lorolist_getShallowValue,Qa=c.loromovablelist_new,ei=c.loromovablelist_kind,ti=c.loromovablelist_insert,ri=c.loromovablelist_delete,ni=c.loromovablelist_get,oi=c.loromovablelist_id,si=c.loromovablelist_toArray,_i=c.loromovablelist_toJSON,ai=c.loromovablelist_insertContainer,ii=c.loromovablelist_pushContainer,ci=c.loromovablelist_subscribe,di=c.loromovablelist_length,li=c.loromovablelist_getAttached,ui=c.loromovablelist_getCursor,pi=c.loromovablelist_move,gi=c.loromovablelist_set,fi=c.loromovablelist_setContainer,hi=c.loromovablelist_push,bi=c.loromovablelist_pop,wi=c.loromovablelist_clear,mi=c.loromovablelist_getCreatorAt,yi=c.loromovablelist_getLastMoverAt,vi=c.loromovablelist_getLastEditorAt,ki=c.loromovablelist_isDeleted,xi=c.loromovablelist_getShallowValue,Si=c.__wbg_lorotree_free,Ai=c.lorotreenode___getClassname,Ci=c.__wbg_lorotreenode_free,Ti=c.lorotreenode_id,Ii=c.lorotreenode_createNode,Oi=c.lorotreenode_move,Ei=c.lorotreenode_moveAfter,Ni=c.lorotreenode_moveBefore,Ri=c.lorotreenode_index,Mi=c.lorotreenode_fractionalIndex,Di=c.lorotreenode_data,ji=c.lorotreenode_toJSON,Li=c.lorotreenode_parent,Ui=c.lorotreenode_children,Zi=c.lorotreenode_isDeleted,Fi=c.lorotreenode_getLastMoveId,Vi=c.lorotreenode_creationId,Pi=c.lorotreenode_creator,Bi=c.lorotree_new,zi=c.lorotree_kind,$i=c.lorotree_createNode,Ji=c.lorotree_move,Wi=c.lorotree_delete,qi=c.lorotree_getNodeByID,Hi=c.lorotree_id,Xi=c.lorotree_has,Yi=c.lorotree_isNodeDeleted,Ki=c.lorotree_toArray,Gi=c.lorotree_getNodes,Qi=c.lorotree_toJSON,ec=c.lorotree_nodes,tc=c.lorotree_roots,rc=c.lorotree_subscribe,nc=c.lorotree_parent,oc=c.lorotree_isAttached,sc=c.lorotree_getAttached,_c=c.lorotree_enableFractionalIndex,ac=c.lorotree_disableFractionalIndex,ic=c.lorotree_isFractionalIndexEnabled,cc=c.lorotree_isDeleted,dc=c.lorotree_getShallowValue,lc=c.__wbg_cursor_free,uc=c.cursor_containerId,pc=c.cursor_pos,gc=c.cursor_side,fc=c.cursor_encode,hc=c.cursor_decode,bc=c.cursor_kind,wc=c.__wbg_undomanager_free,mc=c.undomanager_new,yc=c.undomanager_undo,vc=c.undomanager_redo,kc=c.undomanager_canUndo,xc=c.undomanager_canRedo,Sc=c.undomanager_setMaxUndoSteps,Ac=c.undomanager_setMergeInterval,Cc=c.undomanager_addExcludeOriginPrefix,Tc=c.undomanager_checkBinding,Ic=c.undomanager_setOnPush,Oc=c.undomanager_setOnPop,Ec=c.undomanager_clear,Nc=c.__wbg_versionvector_free,Rc=c.versionvector_new,Mc=c.versionvector_parseJSON,Dc=c.versionvector_toJSON,jc=c.versionvector_encode,Lc=c.versionvector_decode,Uc=c.versionvector_get,Zc=c.versionvector_compare,Fc=c.versionvector_setEnd,Vc=c.versionvector_setLast,Pc=c.versionvector_remove,Bc=c.versionvector_length,zc=c.decodeImportBlobMeta,$c=c.__wbg_loromovablelist_free,Jc=c.loromovablelist_parent,Wc=c.lorotext_isAttached,qc=c.loromap_isAttached,Hc=c.loromovablelist_isAttached,Xc=c.__wbindgen_export_0,Yc=c.__wbindgen_export_1,Kc=c.__wbindgen_export_2,Gc=c.__wbindgen_export_3,Qc=c.__wbindgen_export_4,ed=c.__wbindgen_add_to_stack_pointer,td=c.__wbindgen_export_5,rd=c.__wbindgen_export_6,yt=c.__wbindgen_start;var Pt=Object.freeze({__proto__:null,__wbg_awarenesswasm_free:ts,__wbg_cursor_free:lc,__wbg_lorocounter_free:Jo,__wbg_lorodoc_free:ms,__wbg_lorolist_free:Ea,__wbg_loromap_free:ca,__wbg_loromovablelist_free:$c,__wbg_lorotext_free:j_,__wbg_lorotree_free:Si,__wbg_lorotreenode_free:Ci,__wbg_undomanager_free:wc,__wbg_versionvector_free:Nc,__wbindgen_add_to_stack_pointer:ed,__wbindgen_export_0:Xc,__wbindgen_export_1:Yc,__wbindgen_export_2:Kc,__wbindgen_export_3:Gc,__wbindgen_export_4:Qc,__wbindgen_export_5:td,__wbindgen_export_6:rd,__wbindgen_start:yt,awarenesswasm_apply:ss,awarenesswasm_encode:ns,awarenesswasm_encodeAll:os,awarenesswasm_getAllStates:is,awarenesswasm_getState:cs,awarenesswasm_getTimestamp:ds,awarenesswasm_isEmpty:ps,awarenesswasm_length:us,awarenesswasm_new:rs,awarenesswasm_peer:as,awarenesswasm_peers:gs,awarenesswasm_removeOutdated:ls,awarenesswasm_setLocalState:_s,cursor_containerId:uc,cursor_decode:hc,cursor_encode:fc,cursor_kind:bc,cursor_pos:pc,cursor_side:gc,decodeFrontiers:bs,decodeImportBlobMeta:zc,encodeFrontiers:hs,lorocounter_decrement:Ho,lorocounter_getAttached:Qo,lorocounter_getShallowValue:es,lorocounter_increment:qo,lorocounter_isAttached:Go,lorocounter_new:Wo,lorocounter_parent:Ko,lorocounter_subscribe:Yo,lorocounter_value:Xo,lorodoc_JSONPath:Ks,lorodoc_applyDiff:M_,lorodoc_attach:Ts,lorodoc_changeCount:v_,lorodoc_checkout:js,lorodoc_checkoutToLatest:Rs,lorodoc_cmpFrontiers:__,lorodoc_cmpWithFrontiers:s_,lorodoc_commit:Fs,lorodoc_configTextStyle:As,lorodoc_debugHistory:y_,lorodoc_detach:Os,lorodoc_diff:D_,lorodoc_export:c_,lorodoc_exportFrom:i_,lorodoc_exportJsonInIdSpan:l_,lorodoc_exportJsonUpdates:d_,lorodoc_exportSnapshot:a_,lorodoc_findIdSpansBetween:Ds,lorodoc_fork:Es,lorodoc_forkAt:Ns,lorodoc_fromSnapshot:Cs,lorodoc_frontiers:n_,lorodoc_frontiersToVV:T_,lorodoc_getAllChanges:x_,lorodoc_getByPath:O_,lorodoc_getChangeAt:S_,lorodoc_getChangeAtLamport:A_,lorodoc_getChangedContainersIn:N_,lorodoc_getContainerById:qs,lorodoc_getCounter:Js,lorodoc_getCursorPos:E_,lorodoc_getDeepValueWithID:Xs,lorodoc_getList:zs,lorodoc_getMap:Bs,lorodoc_getMovableList:$s,lorodoc_getOpsInChange:C_,lorodoc_getPathToContainer:Ys,lorodoc_getPendingTxnLength:Vs,lorodoc_getShallowValue:h_,lorodoc_getText:Ps,lorodoc_getTree:Ws,lorodoc_import:p_,lorodoc_importBatch:f_,lorodoc_importJsonUpdates:u_,lorodoc_importUpdateBatch:g_,lorodoc_isDetached:Is,lorodoc_isDetachedEditingEnabled:ks,lorodoc_isShallow:e_,lorodoc_new:ys,lorodoc_opCount:k_,lorodoc_oplogFrontiers:o_,lorodoc_oplogVersion:r_,lorodoc_peerId:Ls,lorodoc_peerIdStr:Us,lorodoc_revertTo:R_,lorodoc_setChangeMergeInterval:Ss,lorodoc_setDetachedEditing:vs,lorodoc_setNextCommitMessage:Hs,lorodoc_setPeerId:Zs,lorodoc_setRecordTimestamp:xs,lorodoc_shallowSinceFrontiers:t_,lorodoc_shallowSinceVV:Qs,lorodoc_subscribe:w_,lorodoc_subscribeLocalUpdates:m_,lorodoc_toJSON:b_,lorodoc_travelChangeAncestors:Ms,lorodoc_version:Gs,lorodoc_vvToFrontiers:I_,lorolist_clear:Xa,lorolist_delete:Da,lorolist_get:ja,lorolist_getAttached:Ja,lorolist_getCursor:Wa,lorolist_getIdAt:Ya,lorolist_getShallowValue:Ga,lorolist_id:La,lorolist_insert:Ma,lorolist_insertContainer:Fa,lorolist_isAttached:$a,lorolist_isDeleted:Ka,lorolist_kind:Ra,lorolist_length:Ba,lorolist_new:Na,lorolist_parent:za,lorolist_pop:Ha,lorolist_push:qa,lorolist_pushContainer:Va,lorolist_subscribe:Pa,lorolist_toArray:Ua,lorolist_toJSON:Za,loromap_clear:Ca,loromap_delete:pa,loromap_entries:wa,loromap_get:ga,loromap_getAttached:Aa,loromap_getLastEditor:Ta,loromap_getOrCreateContainer:fa,loromap_getShallowValue:Oa,loromap_id:ma,loromap_isAttached:qc,loromap_isDeleted:Ia,loromap_keys:ha,loromap_kind:la,loromap_new:da,loromap_parent:Sa,loromap_set:ua,loromap_setContainer:va,loromap_size:xa,loromap_subscribe:ka,loromap_toJSON:ya,loromap_values:ba,loromovablelist_clear:wi,loromovablelist_delete:ri,loromovablelist_get:ni,loromovablelist_getAttached:li,loromovablelist_getCreatorAt:mi,loromovablelist_getCursor:ui,loromovablelist_getLastEditorAt:vi,loromovablelist_getLastMoverAt:yi,loromovablelist_getShallowValue:xi,loromovablelist_id:oi,loromovablelist_insert:ti,loromovablelist_insertContainer:ai,loromovablelist_isAttached:Hc,loromovablelist_isDeleted:ki,loromovablelist_kind:ei,loromovablelist_length:di,loromovablelist_move:pi,loromovablelist_new:Qa,loromovablelist_parent:Jc,loromovablelist_pop:bi,loromovablelist_push:hi,loromovablelist_pushContainer:ii,loromovablelist_set:gi,loromovablelist_setContainer:fi,loromovablelist_subscribe:ci,loromovablelist_toArray:si,loromovablelist_toJSON:_i,lorotext_applyDelta:ta,lorotext_charAt:z_,lorotext_delete:W_,lorotext_deleteUtf8:q_,lorotext_getAttached:na,lorotext_getCursor:oa,lorotext_getEditorOf:_a,lorotext_getShallowValue:ia,lorotext_id:G_,lorotext_insert:P_,lorotext_insertUtf8:J_,lorotext_isAttached:Wc,lorotext_isDeleted:aa,lorotext_iter:Z_,lorotext_kind:U_,lorotext_length:Q_,lorotext_mark:H_,lorotext_new:L_,lorotext_parent:ra,lorotext_push:sa,lorotext_slice:B_,lorotext_splice:$_,lorotext_subscribe:ea,lorotext_toDelta:K_,lorotext_toString:Y_,lorotext_unmark:X_,lorotext_update:F_,lorotext_updateByLine:V_,lorotree_createNode:$i,lorotree_delete:Wi,lorotree_disableFractionalIndex:ac,lorotree_enableFractionalIndex:_c,lorotree_getAttached:sc,lorotree_getNodeByID:qi,lorotree_getNodes:Gi,lorotree_getShallowValue:dc,lorotree_has:Xi,lorotree_id:Hi,lorotree_isAttached:oc,lorotree_isDeleted:cc,lorotree_isFractionalIndexEnabled:ic,lorotree_isNodeDeleted:Yi,lorotree_kind:zi,lorotree_move:Ji,lorotree_new:Bi,lorotree_nodes:ec,lorotree_parent:nc,lorotree_roots:tc,lorotree_subscribe:rc,lorotree_toArray:Ki,lorotree_toJSON:Qi,lorotreenode___getClassname:Ai,lorotreenode_children:Ui,lorotreenode_createNode:Ii,lorotreenode_creationId:Vi,lorotreenode_creator:Pi,lorotreenode_data:Di,lorotreenode_fractionalIndex:Mi,lorotreenode_getLastMoveId:Fi,lorotreenode_id:Ti,lorotreenode_index:Ri,lorotreenode_isDeleted:Zi,lorotreenode_move:Oi,lorotreenode_moveAfter:Ei,lorotreenode_moveBefore:Ni,lorotreenode_parent:Li,lorotreenode_toJSON:ji,memory:$o,run:fs,setDebug:ws,undomanager_addExcludeOriginPrefix:Cc,undomanager_canRedo:xc,undomanager_canUndo:kc,undomanager_checkBinding:Tc,undomanager_clear:Ec,undomanager_new:mc,undomanager_redo:vc,undomanager_setMaxUndoSteps:Sc,undomanager_setMergeInterval:Ac,undomanager_setOnPop:Oc,undomanager_setOnPush:Ic,undomanager_undo:yc,versionvector_compare:Zc,versionvector_decode:Lc,versionvector_encode:jc,versionvector_get:Uc,versionvector_length:Bc,versionvector_new:Rc,versionvector_parseJSON:Mc,versionvector_remove:Pc,versionvector_setEnd:Fc,versionvector_setLast:Vc,versionvector_toJSON:Dc});if(yt)wt(Pt),yt();else{const r=await Promise.resolve().then(function(){return Pt}),e=new WebAssembly.Instance(r.default,{"./loro_wasm_bg.js":zo});wt(e.exports)}const nd=["Map","Text","List","Tree","MovableList","Counter"];function od(r){return r.startsWith("cid:")}function Bt(r){if(typeof r!="object"||r==null)return!1;const e=Object.getPrototypeOf(r);return e==null||typeof e!="object"||typeof e.kind!="function"?!1:nd.includes(r.kind())}B.prototype.toJsonWithReplacer=function(r){const e=this,t=(s,i)=>{if(typeof i=="string"&&od(i)){const p=e.getContainerById(i);if(p==null)throw new Error(`ContainerID not found: ${i}`);const g=r(s,p);if(g===p){const m=p.getShallowValue();return typeof m=="object"?n(m):m}if(Bt(g))throw new Error("Using new container is not allowed in toJsonWithReplacer");return g}const d=r(s,i);if(Bt(d))throw new Error("Using new container is not allowed in toJsonWithReplacer");return d},n=s=>{if(Array.isArray(s))return s.map((d,p)=>t(p,d)).filter(d=>d!==void 0);const i={};for(const[d,p]of Object.entries(s)){const g=t(d,p);g!==void 0&&(i[d]=g)}return i},o=this.getShallowValue();return n(o)};const sd=(r,e)=>{const t=[];for(const n in r)t.push(e(r[n],n));return t},_d=r=>sd(r,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&");class ad{ws;constructor(e){this.ws=e}send(e){try{this.ws.send(e)}catch{this.close()}}close(){this.ws.close()}onMessage(e){this.ws.onmessage=t=>{t.data.arrayBuffer().then(n=>{e(new Uint8Array(n))})}}onClose(e){this.ws.onclose=e}onError(e){this.ws.onerror=e}onOpen(e){this.ws.onopen=e}}class id{params;protocol;constructor(e,t){this.params=e,this.protocol=t}connect(e,t){const n=_d(this.params),o=e+(n.length===0?"":"?"+n),s=new WebSocket(o,this.protocol);return new ad(s)}}const cd=Math.floor,dd=(r,e)=>r<e?r:e,ld=(r,e)=>r>e?r:e,to=128,_t=127,ud=Number.MAX_SAFE_INTEGER,pd=r=>{const e=unescape(encodeURIComponent(r)),t=e.length,n=new Uint8Array(t);for(let o=0;o<t;o++)n[o]=e.codePointAt(o);return n},Me=typeof TextEncoder<"u"?new TextEncoder:null,gd=r=>Me.encode(r),fd=Me?gd:pd;let Re=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Re&&Re.decode(new Uint8Array).length===1&&(Re=null);class hd{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const ro=()=>new hd,bd=r=>{let e=r.cpos;for(let t=0;t<r.bufs.length;t++)e+=r.bufs[t].length;return e},no=r=>{const e=new Uint8Array(bd(r));let t=0;for(let n=0;n<r.bufs.length;n++){const o=r.bufs[n];e.set(o,t),t+=o.length}return e.set(new Uint8Array(r.cbuf.buffer,0,r.cpos),t),e},De=(r,e)=>{const t=r.cbuf.length;r.cpos===t&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(t*2),r.cpos=0),r.cbuf[r.cpos++]=e},oo=De,Tt=(r,e)=>{for(;e>_t;)De(r,to|_t&e),e=cd(e/128);De(r,_t&e)},vt=new Uint8Array(3e4),wd=vt.length/3,md=(r,e)=>{if(e.length<wd){const t=Me.encodeInto(e,vt).written||0;Tt(r,t);for(let n=0;n<t;n++)De(r,vt[n])}else It(r,fd(e))},yd=(r,e)=>{const t=unescape(encodeURIComponent(e)),n=t.length;Tt(r,n);for(let o=0;o<n;o++)De(r,t.codePointAt(o))},so=Me&&Me.encodeInto?md:yd,vd=(r,e)=>{const t=r.cbuf.length,n=r.cpos,o=dd(t-n,e.length),s=e.length-o;r.cbuf.set(e.subarray(0,o),n),r.cpos+=o,s>0&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(ld(t*2,s)),r.cbuf.set(e.subarray(o)),r.cpos=s)},It=(r,e)=>{Tt(r,e.byteLength),vd(r,e)},_o=r=>new Error(r),kd=_o("Unexpected end of array"),xd=_o("Integer out of Range");class Sd{constructor(e){this.arr=e,this.pos=0}}const Ad=r=>new Sd(r),Cd=(r,e)=>{const t=new Uint8Array(r.arr.buffer,r.pos+r.arr.byteOffset,e);return r.pos+=e,t},xe=r=>Cd(r,ao(r)),kt=r=>r.arr[r.pos++],ao=r=>{let e=0,t=1;const n=r.arr.length;for(;r.pos<n;){const o=r.arr[r.pos++];if(e=e+(o&_t)*t,t*=128,o<to)return e;if(e>ud)throw xd}throw kd},Td=r=>{let e=ao(r);if(e===0)return"";{let t=String.fromCodePoint(kt(r));if(--e<100)for(;e--;)t+=String.fromCodePoint(kt(r));else for(;e>0;){const n=e<1e4?e:1e4,o=r.arr.subarray(r.pos,r.pos+n);r.pos+=n,t+=String.fromCodePoint.apply(null,o),e-=n}return decodeURIComponent(escape(t))}},Id=r=>Re.decode(xe(r)),gt=Re?Id:Td,V={canSync:0,startSync:1,postConflict:2,postUpdate:3},Od=(r,e)=>{const t=e.export({mode:"snapshot"}),n=ro();return oo(n,V.canSync),so(n,r),It(n,t),no(n)},Ed=r=>{const e=gt(r),t=xe(r);return{type:V.canSync,docId:e,snapshot:t}},Nd=r=>{const e=gt(r),t=xe(r),n=xe(r);return{type:V.startSync,docId:e,vv:t,updates:n}},Rd=r=>{const e=gt(r),t=xe(r);return{type:V.postConflict,docId:e,snapshot:t}},zt=(r,e)=>{const t=ro();return oo(t,V.postUpdate),so(t,r),It(t,e),no(t)},Md=r=>{const e=gt(r),t=xe(r);return{type:V.postUpdate,docId:e,updates:t}},Dd={[V.canSync]:Ed,[V.startSync]:Nd,[V.postConflict]:Rd,[V.postUpdate]:Md},jd=r=>{const e=Ad(r),t=kt(e),n=Dd[t];if(!n)throw new Error(`Unknown message type: ${t}`);return n(e)},$t=()=>{let r;return{promise:new Promise(t=>{r=t}),resolve:r}};function Ld(r){return{all:r=r||new Map,on:function(e,t){var n=r.get(e);n?n.push(t):r.set(e,[t])},off:function(e,t){var n=r.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):r.set(e,[]))},emit:function(e,t){var n=r.get(e);n&&n.slice().map(function(o){o(t)}),(n=r.get("*"))&&n.slice().map(function(o){o(e,t)})}}}class Ud{connection;url;protocol;network;wsConnected;wsConnecting;docs;shouldReconnect;unsuccessfulReconnects;maxBackoffTime;whenReady;whenReadyResolve;eventBus;constructor(e,t,n){this.connection=null,this.url=e,this.protocol=n,this.network=t,this.docs=new Map,this.wsConnected=!1,this.wsConnecting=!1,this.shouldReconnect=!1,this.unsuccessfulReconnects=0,this.maxBackoffTime=2500;const{promise:o,resolve:s}=$t();this.whenReady=o,this.whenReadyResolve=s,this.eventBus=Ld()}_handleStartSyncMessage=(e,t)=>{console.info(`[wsSynchronizer] Received startSyncMessage, docId: ${e.docId}`);const n=e.doc;n.import(t.updates),console.info(`[wsSynchronizer] Doc ${e.docId} after import updates:`,n.toJSON());const o=F.decode(t.vv);e.lastSentVersion=o;const s=n.export({mode:"update",from:o});if(s.length>0){const i=zt(t.docId,s);this._sendMessage(i),console.info(`[wsSynchronizer] Replied with postUpdateMessage, docId: ${e.docId}`)}e.lastEB=null,queueMicrotask(()=>{const i=e.lastEB!==null;this.eventBus.emit("docSynced",{docId:e.docId,hasSyncEvent:i})})};_handlePostConflictMessage=(e,t)=>{throw new Error("PostConflictMessage handling not implemented")};_handlePostUpdateMessage=(e,t)=>{const n=t.doc;console.info(`[wsSynchronizer] Received postUpdateMessage, docId: ${t.docId}`),n.import(e.updates),console.info(`[wsSynchronizer] Received postUpdateMessage, doc ${t.docId} after import updates:`,n.toJSON()),t.lastEB=null,queueMicrotask(()=>{const o=t.lastEB!==null;this.eventBus.emit("docSynced",{docId:t.docId,hasSyncEvent:o})})};_freeDocs(){for(const e of this.docs.values())e.doc.free();this.docs.clear()}_setupConnection(){this.shouldReconnect&&this.connection===null&&(this.connection=this.network.connect(this.url,this.protocol),this.connection.onOpen(()=>{console.info("[wsSynchronizer] Connection opened"),this.wsConnecting=!1,this.wsConnected=!0,this.unsuccessfulReconnects=0,this.whenReadyResolve()}),this.connection.onMessage(e=>{try{const t=jd(e),n=this.docs.get(t.docId);if(!n){console.error(`[wsSynchronizer] Doc not found: ${t.docId}`);return}t.type===V.startSync?this._handleStartSyncMessage(n,t):t.type===V.postConflict?this._handlePostConflictMessage(t,n):t.type===V.postUpdate?this._handlePostUpdateMessage(t,n):console.error(`[wsSynchronizer] Unknown message type: ${t.type}`)}catch(t){console.error("[wsSynchronizer] Error handling message:",t)}}),this.connection.onError(e=>{console.error("[wsSynchronizer] Connection error:",e)}),this.connection.onClose(()=>{if(console.info("[wsSynchronizer] Connection closed"),this.eventBus.emit("disconnected"),this.connection=null,this.wsConnecting=!1,this.wsConnected){this.wsConnected=!1,this._freeDocs();const{promise:e,resolve:t}=$t();this.whenReady=e,this.whenReadyResolve=t}else this.unsuccessfulReconnects++;setTimeout(()=>this._setupConnection(),Math.min(Math.pow(2,this.unsuccessfulReconnects)*100,this.maxBackoffTime))}),this.wsConnecting=!0,this.wsConnected=!1,this._freeDocs())}_sendMessage(e){const t=this.connection;if(!t){console.error("[wsSynchronizer] Connection not established, cannot send message");return}t.send(e)}_sendNewUpdatesToServer(e){const t=this.docs.get(e);if(!t){console.error(`[wsSynchronizer] Doc ${e} not found`);return}const n=t.doc.export({mode:"update",from:t.lastSentVersion});if(n.length===0)return;t.lastSentVersion=t.doc.version();const o=zt(e,n);this._sendMessage(o),console.info(`[wsSynchronizer] Sent postUpdateMessage, docId: ${e}`)}connect(){this.shouldReconnect=!0,!this.wsConnected&&this.connection===null&&this._setupConnection()}disconnect(){this.shouldReconnect=!1,this.connection!==null&&(this.connection.close(),this.connection=null)}destroy(){this.disconnect()}async addLoroDoc(e,t){if(this.docs.has(e)){console.error(`[wsSynchronizer] Doc already added, do nothing, docId: ${e}`);return}console.info(`[wsSynchronizer] Add new doc, docId: ${e}`);const n={docId:e,doc:t,lastSentVersion:void 0,lastEB:null,subscriptions:[]},o=t.subscribe(s=>{console.info(`[wsSynchronizer] New event on doc ${e}:`,s),s.by==="local"&&this._sendNewUpdatesToServer(e),n.lastEB=s});n.subscriptions.push(o),this.docs.set(e,n),this.whenReady.then(()=>{const s=this.docs.get(e)?.doc;if(!s)return;const i=Od(e,s);this._sendMessage(i),console.info(`[wsSynchronizer] Sent canSyncMessage, docId: ${e}`)})}on(e,t){this.eventBus.on(e,t)}off(e,t){this.eventBus.off(e,t)}}var C;(function(r){r.assertEqual=o=>o;function e(o){}r.assertIs=e;function t(o){throw new Error}r.assertNever=t,r.arrayToEnum=o=>{const s={};for(const i of o)s[i]=i;return s},r.getValidEnumValues=o=>{const s=r.objectKeys(o).filter(d=>typeof o[o[d]]!="number"),i={};for(const d of s)i[d]=o[d];return r.objectValues(i)},r.objectValues=o=>r.objectKeys(o).map(function(s){return o[s]}),r.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const s=[];for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},r.find=(o,s)=>{for(const i of o)if(s(i))return i},r.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}r.joinValues=n,r.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(C||(C={}));var xt;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(xt||(xt={}));const w=C.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Q=r=>{switch(typeof r){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(r)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(r)?w.array:r===null?w.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?w.promise:typeof Map<"u"&&r instanceof Map?w.map:typeof Set<"u"&&r instanceof Set?w.set:typeof Date<"u"&&r instanceof Date?w.date:w.object;default:return w.unknown}},f=C.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Zd=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class P extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},n={_errors:[]},o=s=>{for(const i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let d=n,p=0;for(;p<i.path.length;){const g=i.path[p];p===i.path.length-1?(d[g]=d[g]||{_errors:[]},d[g]._errors.push(t(i))):d[g]=d[g]||{_errors:[]},d=d[g],p++}}};return o(this),n}static assert(e){if(!(e instanceof P))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,C.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const o of this.issues)o.path.length>0?(t[o.path[0]]=t[o.path[0]]||[],t[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}P.create=r=>new P(r);const Se=(r,e)=>{let t;switch(r.code){case f.invalid_type:r.received===w.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case f.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,C.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:t=`Unrecognized key(s) in object: ${C.joinValues(r.keys,", ")}`;break;case f.invalid_union:t="Invalid input";break;case f.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${C.joinValues(r.options)}`;break;case f.invalid_enum_value:t=`Invalid enum value. Expected ${C.joinValues(r.options)}, received '${r.received}'`;break;case f.invalid_arguments:t="Invalid function arguments";break;case f.invalid_return_type:t="Invalid function return type";break;case f.invalid_date:t="Invalid date";break;case f.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:C.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case f.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case f.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case f.custom:t="Invalid input";break;case f.invalid_intersection_types:t="Intersection results could not be merged";break;case f.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case f.not_finite:t="Number must be finite";break;default:t=e.defaultError,C.assertNever(r)}return{message:t}};let io=Se;function Fd(r){io=r}function at(){return io}const it=r=>{const{data:e,path:t,errorMaps:n,issueData:o}=r,s=[...t,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let d="";const p=n.filter(g=>!!g).slice().reverse();for(const g of p)d=g(i,{data:e,defaultError:d}).message;return{...o,path:s,message:d}},Vd=[];function b(r,e){const t=at(),n=it({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Se?void 0:Se].filter(o=>!!o)});r.common.issues.push(n)}class D{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const o of t){if(o.status==="aborted")return k;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const o of t){const s=await o.key,i=await o.value;n.push({key:s,value:i})}return D.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const o of t){const{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return k;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}}const k=Object.freeze({status:"aborted"}),we=r=>({status:"dirty",value:r}),L=r=>({status:"valid",value:r}),St=r=>r.status==="aborted",At=r=>r.status==="dirty",ge=r=>r.status==="valid",je=r=>typeof Promise<"u"&&r instanceof Promise;function ct(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function co(r,e,t,n,o){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var y;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(y||(y={}));var Oe,Ee;class Y{constructor(e,t,n,o){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=o}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Jt=(r,e)=>{if(ge(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new P(r.common.issues);return this._error=t,this._error}}};function S(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:o}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,d)=>{var p,g;const{message:m}=r;return i.code==="invalid_enum_value"?{message:m??d.defaultError}:typeof d.data>"u"?{message:(p=m??n)!==null&&p!==void 0?p:d.defaultError}:i.code!=="invalid_type"?{message:d.defaultError}:{message:(g=m??t)!==null&&g!==void 0?g:d.defaultError}},description:o}}class A{get description(){return this._def.description}_getType(e){return Q(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Q(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new D,ctx:{common:e.parent.common,data:e.data,parsedType:Q(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(je(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const o={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Q(e)},s=this._parseSync({data:e,path:o.path,parent:o});return Jt(o,s)}"~validate"(e){var t,n;const o={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Q(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:o});return ge(s)?{value:s.value}:{issues:o.common.issues}}catch(s){!((n=(t=s?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),o.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:o}).then(s=>ge(s)?{value:s.value}:{issues:o.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Q(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await (je(o)?o:Promise.resolve(o));return Jt(n,s)}refine(e,t){const n=o=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(o):t;return this._refinement((o,s)=>{const i=e(o),d=()=>s.addIssue({code:f.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(p=>p?!0:(d(),!1)):i?!0:(d(),!1)})}refinement(e,t){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof t=="function"?t(n,o):t),!1))}_refinement(e){return new W({schema:this,typeName:v.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return X.create(this,this._def)}nullable(){return ce.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return J.create(this)}promise(){return Ce.create(this,this._def)}or(e){return Fe.create([this,e],this._def)}and(e){return Ve.create(this,e,this._def)}transform(e){return new W({...S(this._def),schema:this,typeName:v.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Je({...S(this._def),innerType:this,defaultValue:t,typeName:v.ZodDefault})}brand(){return new Ot({typeName:v.ZodBranded,type:this,...S(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new We({...S(this._def),innerType:this,catchValue:t,typeName:v.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Qe.create(this,e)}readonly(){return qe.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Pd=/^c[^\s-]{8,}$/i,Bd=/^[0-9a-z]+$/,zd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$d=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Jd=/^[a-z0-9_-]{21}$/i,Wd=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,qd=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Hd=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Xd="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let bt;const Yd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Kd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Gd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Qd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,el=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,lo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rl=new RegExp(`^${lo}$`);function uo(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function nl(r){return new RegExp(`^${uo(r)}$`)}function po(r){let e=`${lo}T${uo(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function ol(r,e){return!!((e==="v4"||!e)&&Yd.test(r)||(e==="v6"||!e)&&Gd.test(r))}function sl(r,e){if(!Wd.test(r))return!1;try{const[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||!o.typ||!o.alg||e&&o.alg!==e)}catch{return!1}}function _l(r,e){return!!((e==="v4"||!e)&&Kd.test(r)||(e==="v6"||!e)&&Qd.test(r))}class z extends A{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){const s=this._getOrReturnCtx(e);return b(s,{code:f.invalid_type,expected:w.string,received:s.parsedType}),k}const n=new D;let o;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),b(o,{code:f.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),b(o,{code:f.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const i=e.data.length>s.value,d=e.data.length<s.value;(i||d)&&(o=this._getOrReturnCtx(e,o),i?b(o,{code:f.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):d&&b(o,{code:f.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Hd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"email",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")bt||(bt=new RegExp(Xd,"u")),bt.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"emoji",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")$d.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"uuid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Jd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"nanoid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Pd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"cuid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Bd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"cuid2",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")zd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"ulid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),b(o,{validation:"url",code:f.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"regex",code:f.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?po(s).test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?rl.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?nl(s).test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{code:f.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?qd.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"duration",code:f.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?ol(e.data,s.version)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"ip",code:f.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?sl(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"jwt",code:f.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?_l(e.data,s.version)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"cidr",code:f.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?el.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"base64",code:f.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?tl.test(e.data)||(o=this._getOrReturnCtx(e,o),b(o,{validation:"base64url",code:f.invalid_string,message:s.message}),n.dirty()):C.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(o=>e.test(o),{validation:t,code:f.invalid_string,...y.errToObj(n)})}_addCheck(e){return new z({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...y.errToObj(e)})}url(e){return this._addCheck({kind:"url",...y.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...y.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...y.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...y.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...y.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...y.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...y.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...y.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...y.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...y.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...y.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...y.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...y.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...y.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...y.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...y.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...y.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...y.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...y.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...y.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...y.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...y.errToObj(t)})}nonempty(e){return this.min(1,y.errToObj(e))}trim(){return new z({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new z({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new z({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}z.create=r=>{var e;return new z({checks:[],typeName:v.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...S(r)})};function al(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=t>n?t:n,s=parseInt(r.toFixed(o).replace(".","")),i=parseInt(e.toFixed(o).replace(".",""));return s%i/Math.pow(10,o)}class _e extends A{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){const s=this._getOrReturnCtx(e);return b(s,{code:f.invalid_type,expected:w.number,received:s.parsedType}),k}let n;const o=new D;for(const s of this._def.checks)s.kind==="int"?C.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:f.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?al(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_finite,message:s.message}),o.dirty()):C.assertNever(s);return{status:o.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,y.toString(t))}setLimit(e,t,n,o){return new _e({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:y.toString(o)}]})}_addCheck(e){return new _e({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:y.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:y.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:y.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:y.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:y.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&C.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}_e.create=r=>new _e({checks:[],typeName:v.ZodNumber,coerce:r?.coerce||!1,...S(r)});class ae extends A{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n;const o=new D;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):C.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return b(t,{code:f.invalid_type,expected:w.bigint,received:t.parsedType}),k}gte(e,t){return this.setLimit("min",e,!0,y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,y.toString(t))}setLimit(e,t,n,o){return new ae({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:y.toString(o)}]})}_addCheck(e){return new ae({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:y.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ae.create=r=>{var e;return new ae({checks:[],typeName:v.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...S(r)})};class Le extends A{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.boolean,received:n.parsedType}),k}return L(e.data)}}Le.create=r=>new Le({typeName:v.ZodBoolean,coerce:r?.coerce||!1,...S(r)});class fe extends A{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){const s=this._getOrReturnCtx(e);return b(s,{code:f.invalid_type,expected:w.date,received:s.parsedType}),k}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return b(s,{code:f.invalid_date}),k}const n=new D;let o;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),b(o,{code:f.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),b(o,{code:f.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):C.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new fe({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:y.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:y.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}fe.create=r=>new fe({checks:[],coerce:r?.coerce||!1,typeName:v.ZodDate,...S(r)});class dt extends A{_parse(e){if(this._getType(e)!==w.symbol){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.symbol,received:n.parsedType}),k}return L(e.data)}}dt.create=r=>new dt({typeName:v.ZodSymbol,...S(r)});class Ue extends A{_parse(e){if(this._getType(e)!==w.undefined){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.undefined,received:n.parsedType}),k}return L(e.data)}}Ue.create=r=>new Ue({typeName:v.ZodUndefined,...S(r)});class Ze extends A{_parse(e){if(this._getType(e)!==w.null){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.null,received:n.parsedType}),k}return L(e.data)}}Ze.create=r=>new Ze({typeName:v.ZodNull,...S(r)});class Ae extends A{constructor(){super(...arguments),this._any=!0}_parse(e){return L(e.data)}}Ae.create=r=>new Ae({typeName:v.ZodAny,...S(r)});class le extends A{constructor(){super(...arguments),this._unknown=!0}_parse(e){return L(e.data)}}le.create=r=>new le({typeName:v.ZodUnknown,...S(r)});class re extends A{_parse(e){const t=this._getOrReturnCtx(e);return b(t,{code:f.invalid_type,expected:w.never,received:t.parsedType}),k}}re.create=r=>new re({typeName:v.ZodNever,...S(r)});class lt extends A{_parse(e){if(this._getType(e)!==w.undefined){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.void,received:n.parsedType}),k}return L(e.data)}}lt.create=r=>new lt({typeName:v.ZodVoid,...S(r)});class J extends A{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),o=this._def;if(t.parsedType!==w.array)return b(t,{code:f.invalid_type,expected:w.array,received:t.parsedType}),k;if(o.exactLength!==null){const i=t.data.length>o.exactLength.value,d=t.data.length<o.exactLength.value;(i||d)&&(b(t,{code:i?f.too_big:f.too_small,minimum:d?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&t.data.length<o.minLength.value&&(b(t,{code:f.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&t.data.length>o.maxLength.value&&(b(t,{code:f.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,d)=>o.type._parseAsync(new Y(t,i,t.path,d)))).then(i=>D.mergeArray(n,i));const s=[...t.data].map((i,d)=>o.type._parseSync(new Y(t,i,t.path,d)));return D.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new J({...this._def,minLength:{value:e,message:y.toString(t)}})}max(e,t){return new J({...this._def,maxLength:{value:e,message:y.toString(t)}})}length(e,t){return new J({...this._def,exactLength:{value:e,message:y.toString(t)}})}nonempty(e){return this.min(1,e)}}J.create=(r,e)=>new J({type:r,minLength:null,maxLength:null,exactLength:null,typeName:v.ZodArray,...S(e)});function be(r){if(r instanceof I){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=X.create(be(n))}return new I({...r._def,shape:()=>e})}else return r instanceof J?new J({...r._def,type:be(r.element)}):r instanceof X?X.create(be(r.unwrap())):r instanceof ce?ce.create(be(r.unwrap())):r instanceof K?K.create(r.items.map(e=>be(e))):r}class I extends A{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=C.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==w.object){const g=this._getOrReturnCtx(e);return b(g,{code:f.invalid_type,expected:w.object,received:g.parsedType}),k}const{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),d=[];if(!(this._def.catchall instanceof re&&this._def.unknownKeys==="strip"))for(const g in o.data)i.includes(g)||d.push(g);const p=[];for(const g of i){const m=s[g],E=o.data[g];p.push({key:{status:"valid",value:g},value:m._parse(new Y(o,E,o.path,g)),alwaysSet:g in o.data})}if(this._def.catchall instanceof re){const g=this._def.unknownKeys;if(g==="passthrough")for(const m of d)p.push({key:{status:"valid",value:m},value:{status:"valid",value:o.data[m]}});else if(g==="strict")d.length>0&&(b(o,{code:f.unrecognized_keys,keys:d}),n.dirty());else if(g!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const g=this._def.catchall;for(const m of d){const E=o.data[m];p.push({key:{status:"valid",value:m},value:g._parse(new Y(o,E,o.path,m)),alwaysSet:m in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const g=[];for(const m of p){const E=await m.key,ne=await m.value;g.push({key:E,value:ne,alwaysSet:m.alwaysSet})}return g}).then(g=>D.mergeObjectSync(n,g)):D.mergeObjectSync(n,p)}get shape(){return this._def.shape()}strict(e){return y.errToObj,new I({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var o,s,i,d;const p=(i=(s=(o=this._def).errorMap)===null||s===void 0?void 0:s.call(o,t,n).message)!==null&&i!==void 0?i:n.defaultError;return t.code==="unrecognized_keys"?{message:(d=y.errToObj(e).message)!==null&&d!==void 0?d:p}:{message:p}}}:{}})}strip(){return new I({...this._def,unknownKeys:"strip"})}passthrough(){return new I({...this._def,unknownKeys:"passthrough"})}extend(e){return new I({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new I({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:v.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new I({...this._def,catchall:e})}pick(e){const t={};return C.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new I({...this._def,shape:()=>t})}omit(e){const t={};return C.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new I({...this._def,shape:()=>t})}deepPartial(){return be(this)}partial(e){const t={};return C.objectKeys(this.shape).forEach(n=>{const o=this.shape[n];e&&!e[n]?t[n]=o:t[n]=o.optional()}),new I({...this._def,shape:()=>t})}required(e){const t={};return C.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof X;)s=s._def.innerType;t[n]=s}}),new I({...this._def,shape:()=>t})}keyof(){return go(C.objectKeys(this.shape))}}I.create=(r,e)=>new I({shape:()=>r,unknownKeys:"strip",catchall:re.create(),typeName:v.ZodObject,...S(e)});I.strictCreate=(r,e)=>new I({shape:()=>r,unknownKeys:"strict",catchall:re.create(),typeName:v.ZodObject,...S(e)});I.lazycreate=(r,e)=>new I({shape:r,unknownKeys:"strip",catchall:re.create(),typeName:v.ZodObject,...S(e)});class Fe extends A{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function o(s){for(const d of s)if(d.result.status==="valid")return d.result;for(const d of s)if(d.result.status==="dirty")return t.common.issues.push(...d.ctx.common.issues),d.result;const i=s.map(d=>new P(d.ctx.common.issues));return b(t,{code:f.invalid_union,unionErrors:i}),k}if(t.common.async)return Promise.all(n.map(async s=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(o);{let s;const i=[];for(const p of n){const g={...t,common:{...t.common,issues:[]},parent:null},m=p._parseSync({data:t.data,path:t.path,parent:g});if(m.status==="valid")return m;m.status==="dirty"&&!s&&(s={result:m,ctx:g}),g.common.issues.length&&i.push(g.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const d=i.map(p=>new P(p));return b(t,{code:f.invalid_union,unionErrors:d}),k}}get options(){return this._def.options}}Fe.create=(r,e)=>new Fe({options:r,typeName:v.ZodUnion,...S(e)});const G=r=>r instanceof Be?G(r.schema):r instanceof W?G(r.innerType()):r instanceof ze?[r.value]:r instanceof ie?r.options:r instanceof $e?C.objectValues(r.enum):r instanceof Je?G(r._def.innerType):r instanceof Ue?[void 0]:r instanceof Ze?[null]:r instanceof X?[void 0,...G(r.unwrap())]:r instanceof ce?[null,...G(r.unwrap())]:r instanceof Ot||r instanceof qe?G(r.unwrap()):r instanceof We?G(r._def.innerType):[];class ft extends A{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==w.object)return b(t,{code:f.invalid_type,expected:w.object,received:t.parsedType}),k;const n=this.discriminator,o=t.data[n],s=this.optionsMap.get(o);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(b(t,{code:f.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),k)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const o=new Map;for(const s of t){const i=G(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const d of i){if(o.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);o.set(d,s)}}return new ft({typeName:v.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:o,...S(n)})}}function Ct(r,e){const t=Q(r),n=Q(e);if(r===e)return{valid:!0,data:r};if(t===w.object&&n===w.object){const o=C.objectKeys(e),s=C.objectKeys(r).filter(d=>o.indexOf(d)!==-1),i={...r,...e};for(const d of s){const p=Ct(r[d],e[d]);if(!p.valid)return{valid:!1};i[d]=p.data}return{valid:!0,data:i}}else if(t===w.array&&n===w.array){if(r.length!==e.length)return{valid:!1};const o=[];for(let s=0;s<r.length;s++){const i=r[s],d=e[s],p=Ct(i,d);if(!p.valid)return{valid:!1};o.push(p.data)}return{valid:!0,data:o}}else return t===w.date&&n===w.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Ve extends A{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=(s,i)=>{if(St(s)||St(i))return k;const d=Ct(s.value,i.value);return d.valid?((At(s)||At(i))&&t.dirty(),{status:t.value,value:d.data}):(b(n,{code:f.invalid_intersection_types}),k)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Ve.create=(r,e,t)=>new Ve({left:r,right:e,typeName:v.ZodIntersection,...S(t)});class K extends A{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==w.array)return b(n,{code:f.invalid_type,expected:w.array,received:n.parsedType}),k;if(n.data.length<this._def.items.length)return b(n,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),k;!this._def.rest&&n.data.length>this._def.items.length&&(b(n,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...n.data].map((i,d)=>{const p=this._def.items[d]||this._def.rest;return p?p._parse(new Y(n,i,n.path,d)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>D.mergeArray(t,i)):D.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new K({...this._def,rest:e})}}K.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new K({items:r,typeName:v.ZodTuple,rest:null,...S(e)})};class Pe extends A{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==w.object)return b(n,{code:f.invalid_type,expected:w.object,received:n.parsedType}),k;const o=[],s=this._def.keyType,i=this._def.valueType;for(const d in n.data)o.push({key:s._parse(new Y(n,d,n.path,d)),value:i._parse(new Y(n,n.data[d],n.path,d)),alwaysSet:d in n.data});return n.common.async?D.mergeObjectAsync(t,o):D.mergeObjectSync(t,o)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof A?new Pe({keyType:e,valueType:t,typeName:v.ZodRecord,...S(n)}):new Pe({keyType:z.create(),valueType:e,typeName:v.ZodRecord,...S(t)})}}class ut extends A{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==w.map)return b(n,{code:f.invalid_type,expected:w.map,received:n.parsedType}),k;const o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([d,p],g)=>({key:o._parse(new Y(n,d,n.path,[g,"key"])),value:s._parse(new Y(n,p,n.path,[g,"value"]))}));if(n.common.async){const d=new Map;return Promise.resolve().then(async()=>{for(const p of i){const g=await p.key,m=await p.value;if(g.status==="aborted"||m.status==="aborted")return k;(g.status==="dirty"||m.status==="dirty")&&t.dirty(),d.set(g.value,m.value)}return{status:t.value,value:d}})}else{const d=new Map;for(const p of i){const g=p.key,m=p.value;if(g.status==="aborted"||m.status==="aborted")return k;(g.status==="dirty"||m.status==="dirty")&&t.dirty(),d.set(g.value,m.value)}return{status:t.value,value:d}}}}ut.create=(r,e,t)=>new ut({valueType:e,keyType:r,typeName:v.ZodMap,...S(t)});class he extends A{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==w.set)return b(n,{code:f.invalid_type,expected:w.set,received:n.parsedType}),k;const o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(b(n,{code:f.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),t.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(b(n,{code:f.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),t.dirty());const s=this._def.valueType;function i(p){const g=new Set;for(const m of p){if(m.status==="aborted")return k;m.status==="dirty"&&t.dirty(),g.add(m.value)}return{status:t.value,value:g}}const d=[...n.data.values()].map((p,g)=>s._parse(new Y(n,p,n.path,g)));return n.common.async?Promise.all(d).then(p=>i(p)):i(d)}min(e,t){return new he({...this._def,minSize:{value:e,message:y.toString(t)}})}max(e,t){return new he({...this._def,maxSize:{value:e,message:y.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}he.create=(r,e)=>new he({valueType:r,minSize:null,maxSize:null,typeName:v.ZodSet,...S(e)});class ye extends A{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==w.function)return b(t,{code:f.invalid_type,expected:w.function,received:t.parsedType}),k;function n(d,p){return it({data:d,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,at(),Se].filter(g=>!!g),issueData:{code:f.invalid_arguments,argumentsError:p}})}function o(d,p){return it({data:d,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,at(),Se].filter(g=>!!g),issueData:{code:f.invalid_return_type,returnTypeError:p}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Ce){const d=this;return L(async function(...p){const g=new P([]),m=await d._def.args.parseAsync(p,s).catch(Ie=>{throw g.addIssue(n(p,Ie)),g}),E=await Reflect.apply(i,this,m);return await d._def.returns._def.type.parseAsync(E,s).catch(Ie=>{throw g.addIssue(o(E,Ie)),g})})}else{const d=this;return L(function(...p){const g=d._def.args.safeParse(p,s);if(!g.success)throw new P([n(p,g.error)]);const m=Reflect.apply(i,this,g.data),E=d._def.returns.safeParse(m,s);if(!E.success)throw new P([o(m,E.error)]);return E.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ye({...this._def,args:K.create(e).rest(le.create())})}returns(e){return new ye({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ye({args:e||K.create([]).rest(le.create()),returns:t||le.create(),typeName:v.ZodFunction,...S(n)})}}class Be extends A{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Be.create=(r,e)=>new Be({getter:r,typeName:v.ZodLazy,...S(e)});class ze extends A{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return b(t,{received:t.data,code:f.invalid_literal,expected:this._def.value}),k}return{status:"valid",value:e.data}}get value(){return this._def.value}}ze.create=(r,e)=>new ze({value:r,typeName:v.ZodLiteral,...S(e)});function go(r,e){return new ie({values:r,typeName:v.ZodEnum,...S(e)})}class ie extends A{constructor(){super(...arguments),Oe.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return b(t,{expected:C.joinValues(n),received:t.parsedType,code:f.invalid_type}),k}if(ct(this,Oe)||co(this,Oe,new Set(this._def.values)),!ct(this,Oe).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return b(t,{received:t.data,code:f.invalid_enum_value,options:n}),k}return L(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ie.create(e,{...this._def,...t})}exclude(e,t=this._def){return ie.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}Oe=new WeakMap;ie.create=go;class $e extends A{constructor(){super(...arguments),Ee.set(this,void 0)}_parse(e){const t=C.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==w.string&&n.parsedType!==w.number){const o=C.objectValues(t);return b(n,{expected:C.joinValues(o),received:n.parsedType,code:f.invalid_type}),k}if(ct(this,Ee)||co(this,Ee,new Set(C.getValidEnumValues(this._def.values))),!ct(this,Ee).has(e.data)){const o=C.objectValues(t);return b(n,{received:n.data,code:f.invalid_enum_value,options:o}),k}return L(e.data)}get enum(){return this._def.values}}Ee=new WeakMap;$e.create=(r,e)=>new $e({values:r,typeName:v.ZodNativeEnum,...S(e)});class Ce extends A{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==w.promise&&t.common.async===!1)return b(t,{code:f.invalid_type,expected:w.promise,received:t.parsedType}),k;const n=t.parsedType===w.promise?t.data:Promise.resolve(t.data);return L(n.then(o=>this._def.type.parseAsync(o,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ce.create=(r,e)=>new Ce({type:r,typeName:v.ZodPromise,...S(e)});class W extends A{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===v.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{b(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){const i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async d=>{if(t.value==="aborted")return k;const p=await this._def.schema._parseAsync({data:d,path:n.path,parent:n});return p.status==="aborted"?k:p.status==="dirty"||t.value==="dirty"?we(p.value):p});{if(t.value==="aborted")return k;const d=this._def.schema._parseSync({data:i,path:n.path,parent:n});return d.status==="aborted"?k:d.status==="dirty"||t.value==="dirty"?we(d.value):d}}if(o.type==="refinement"){const i=d=>{const p=o.refinement(d,s);if(n.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(n.common.async===!1){const d=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return d.status==="aborted"?k:(d.status==="dirty"&&t.dirty(),i(d.value),{status:t.value,value:d.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(d=>d.status==="aborted"?k:(d.status==="dirty"&&t.dirty(),i(d.value).then(()=>({status:t.value,value:d.value}))))}if(o.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ge(i))return i;const d=o.transform(i.value,s);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:d}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>ge(i)?Promise.resolve(o.transform(i.value,s)).then(d=>({status:t.value,value:d})):i);C.assertNever(o)}}W.create=(r,e,t)=>new W({schema:r,typeName:v.ZodEffects,effect:e,...S(t)});W.createWithPreprocess=(r,e,t)=>new W({schema:e,effect:{type:"preprocess",transform:r},typeName:v.ZodEffects,...S(t)});class X extends A{_parse(e){return this._getType(e)===w.undefined?L(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}X.create=(r,e)=>new X({innerType:r,typeName:v.ZodOptional,...S(e)});class ce extends A{_parse(e){return this._getType(e)===w.null?L(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ce.create=(r,e)=>new ce({innerType:r,typeName:v.ZodNullable,...S(e)});class Je extends A{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===w.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Je.create=(r,e)=>new Je({innerType:r,typeName:v.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...S(e)});class We extends A{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return je(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new P(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new P(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}We.create=(r,e)=>new We({innerType:r,typeName:v.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...S(e)});class pt extends A{_parse(e){if(this._getType(e)!==w.nan){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:w.nan,received:n.parsedType}),k}return{status:"valid",value:e.data}}}pt.create=r=>new pt({typeName:v.ZodNaN,...S(r)});const il=Symbol("zod_brand");class Ot extends A{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Qe extends A{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?k:s.status==="dirty"?(t.dirty(),we(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?k:o.status==="dirty"?(t.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,t){return new Qe({in:e,out:t,typeName:v.ZodPipeline})}}class qe extends A{_parse(e){const t=this._def.innerType._parse(e),n=o=>(ge(o)&&(o.value=Object.freeze(o.value)),o);return je(t)?t.then(o=>n(o)):n(t)}unwrap(){return this._def.innerType}}qe.create=(r,e)=>new qe({innerType:r,typeName:v.ZodReadonly,...S(e)});function fo(r,e={},t){return r?Ae.create().superRefine((n,o)=>{var s,i;if(!r(n)){const d=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,p=(i=(s=d.fatal)!==null&&s!==void 0?s:t)!==null&&i!==void 0?i:!0,g=typeof d=="string"?{message:d}:d;o.addIssue({code:"custom",...g,fatal:p})}}):Ae.create()}const cl={object:I.lazycreate};var v;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(v||(v={}));const dl=(r,e={message:`Input not instance of ${r.name}`})=>fo(t=>t instanceof r,e),ho=z.create,bo=_e.create,ll=pt.create,ul=ae.create,wo=Le.create,pl=fe.create,gl=dt.create,fl=Ue.create,hl=Ze.create,bl=Ae.create,wl=le.create,ml=re.create,yl=lt.create,vl=J.create,kl=I.create,xl=I.strictCreate,Sl=Fe.create,Al=ft.create,Cl=Ve.create,Tl=K.create,Il=Pe.create,Ol=ut.create,El=he.create,Nl=ye.create,Rl=Be.create,Ml=ze.create,Dl=ie.create,jl=$e.create,Ll=Ce.create,Wt=W.create,Ul=X.create,Zl=ce.create,Fl=W.createWithPreprocess,Vl=Qe.create,Pl=()=>ho().optional(),Bl=()=>bo().optional(),zl=()=>wo().optional(),$l={string:r=>z.create({...r,coerce:!0}),number:r=>_e.create({...r,coerce:!0}),boolean:r=>Le.create({...r,coerce:!0}),bigint:r=>ae.create({...r,coerce:!0}),date:r=>fe.create({...r,coerce:!0})},Jl=k;var q=Object.freeze({__proto__:null,defaultErrorMap:Se,setErrorMap:Fd,getErrorMap:at,makeIssue:it,EMPTY_PATH:Vd,addIssueToContext:b,ParseStatus:D,INVALID:k,DIRTY:we,OK:L,isAborted:St,isDirty:At,isValid:ge,isAsync:je,get util(){return C},get objectUtil(){return xt},ZodParsedType:w,getParsedType:Q,ZodType:A,datetimeRegex:po,ZodString:z,ZodNumber:_e,ZodBigInt:ae,ZodBoolean:Le,ZodDate:fe,ZodSymbol:dt,ZodUndefined:Ue,ZodNull:Ze,ZodAny:Ae,ZodUnknown:le,ZodNever:re,ZodVoid:lt,ZodArray:J,ZodObject:I,ZodUnion:Fe,ZodDiscriminatedUnion:ft,ZodIntersection:Ve,ZodTuple:K,ZodRecord:Pe,ZodMap:ut,ZodSet:he,ZodFunction:ye,ZodLazy:Be,ZodLiteral:ze,ZodEnum:ie,ZodNativeEnum:$e,ZodPromise:Ce,ZodEffects:W,ZodTransformer:W,ZodOptional:X,ZodNullable:ce,ZodDefault:Je,ZodCatch:We,ZodNaN:pt,BRAND:il,ZodBranded:Ot,ZodPipeline:Qe,ZodReadonly:qe,custom:fo,Schema:A,ZodSchema:A,late:cl,get ZodFirstPartyTypeKind(){return v},coerce:$l,any:bl,array:vl,bigint:ul,boolean:wo,date:pl,discriminatedUnion:Al,effect:Wt,enum:Dl,function:Nl,instanceof:dl,intersection:Cl,lazy:Rl,literal:Ml,map:Ol,nan:ll,nativeEnum:jl,never:ml,null:hl,nullable:Zl,number:bo,object:kl,oboolean:zl,onumber:Bl,optional:Ul,ostring:Pl,pipeline:Vl,preprocess:Fl,promise:Ll,record:Il,set:El,strictObject:xl,string:ho,symbol:gl,transformer:Wt,tuple:Tl,undefined:fl,union:Sl,unknown:wl,void:yl,NEVER:Jl,ZodIssueCode:f,quotelessJson:Zd,ZodError:P});const mo={SUCCESS:0,INVALID_REQUEST:1,PASSWORD_INCORRECT:2,EXCEED_MAX_ATTEMPTS:3,NO_AUTHORIZATION:4,UNKNOWN_ERROR:5,TARGET_NOT_FOUND:6,INVALID_RESPONSE:7,NO_AXIOS:8,FILE_EXISTS:9,DIR_NOT_FOUND:10,TOKEN_EXPIRED:11,PATH_NOT_FOUND:12,PATH_EXISTS_AND_NOT_EMPTY:13,PATH_CANNOT_ACCESS:14},Wl=Object.fromEntries(Object.entries(mo).map(([r,e])=>[e,r]));({...mo,...Wl});const ql="blockInfo",Hl="blockData_",ht="data";q.any().pipe(q.union([q.object({type:q.literal("ui"),changeSources:q.array(q.string()).optional()}),q.object({type:q.literal("local")}),q.object({type:q.literal("remote")})]));const ve=r=>{postMessage(r)};let qt,Ht,Xt,ee,ke,oe,de;const Xl=r=>{const[e,t]=r.split("://");return e==="https"?`wss://${t}`:`ws://${t}`};addEventListener("message",r=>{const e=r.data;switch(e.type){case"connect":Yl(e.serverUrl,e.location,e.token);break;case"disconnect":yo();break;case"loadDataDoc":vo(e.docId);break;case"unloadDataDoc":Kl(e.docId);break;case"postYjsLayerTransaction":Gl(e.transaction);break;case"_printBlockInfo":console.debug("[syncWorker] _printBlockInfo",oe?.get(e.blockId));break;case"_printBlockData":const n=de?.get(0)?.getMap(ht);console.debug("[syncWorker] _printBlockData",n?.get(e.blockId));break}});const yo=()=>{ee?.disconnect(),ee?.destroy(),ke=void 0,oe=void 0,de=void 0,ee=void 0},Yl=(r,e,t)=>{yo(),console.debug("[syncWorker] connect",r,e,t),qt=r,Ht=e,Xt=t,ke=new B,oe=ke.getMap(ht),de=new Map,oe.subscribe(n=>{const o={type:n.by==="local"?"ui":"remote"},s=[];for(const i of n.events)if(i.diff.type==="map")for(const[d,p]of Object.entries(i.diff.updated))p==null?s.push({op:"delete",key:d}):s.push({op:"upsert",key:d,value:p});ve({type:"blockInfoMapChange",origin:o,changes:s})}),(async()=>{const n=new id({location:Ht,authorization:Xt});ee=new Ud(Xl(qt),n),ee.connect(),ee.addLoroDoc(ql,ke),ee.on("docSynced",({docId:o,hasSyncEvent:s})=>{console.info("[syncWorker] wsSynchronizer docSynced, docId:",o,"hasSyncEvent:",s),ve({type:"docSynced",docId:o,hasSyncEvent:s})}),ee.on("disconnected",()=>{console.info("[syncWorker] wsSynchronizer disconnected"),ve({type:"disconnected"})})})()},vo=r=>{if(!de){console.error("[syncWorker] 数据文档未初始化，先 connect 以初始化");return}if(de.has(r))return de.get(r);const e=new B,t=e.getMap(ht);return de.set(r,e),ve({type:"dataDocCreated",dataDocId:r}),t.subscribe(n=>{const o={type:n.by==="local"?"ui":"remote"},s=[];for(const i of n.events)if(i.diff.type==="map")for(const[d,p]of Object.entries(i.diff.updated))p==null?s.push({op:"delete",key:d}):s.push({op:"upsert",key:d,value:p});ve({type:"blockDataMapChange",dataDocId:r,origin:o,changes:s})}),(async()=>(console.debug("[syncWorker] dataDoc 加入 wsSynchronizer，开始同步"),await xo(1e3),ee?.addLoroDoc(Hl+r,e)))(),e},Kl=r=>{console.error("[syncWorker] Not implemented")},Gl=r=>{if(!ke||!oe){console.error("[syncWorker] baseDoc or blockInfoMap is null, cannot commit");return}if(!oe)return;for(const t of r.patches)t.op==="upsertBlockInfo"?oe.set(t.blockId,t.blockInfo):t.op==="deleteBlockInfo"&&oe.delete(t.blockId);console.log("[syncWorker] Commit blockInfoMap transaction"),ke.commit();const e=new Map;for(const t of r.patches)if(t.op==="upsertBlockData"||t.op==="deleteBlockData"){const n=e.get(t.docId);n?n.push(t):e.set(t.docId,[t])}for(const[t,n]of e.entries()){const o=vo(t);if(!o)continue;const s=o.getMap(ht);for(const i of n)i.op==="upsertBlockData"?s.set(i.blockId,i.blockData):i.op==="deleteBlockData"&&s.delete(i.blockId);console.log("[syncWorker] Commit blockDataMap transaction, docId:",t),o.commit()}};ve({type:"init"})})();